<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>政务管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* 重置默认样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-x: hidden;
        }
        
        /* 处理移动端状态栏 */
        body {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }
        
        /* 优化滚动体验 */
        html {
            scroll-behavior: smooth;
        }
        
        /* 确保内容区域可以正常滚动 */
        #mainApp {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* 底部导航固定定位 */
        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: white;
            border-top: 1px solid #e5e7eb;
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .nav-item.active {
            color: #2563eb;
            background-color: #eff6ff;
        }
        

        
        /* 确保登录页面始终居中显示 */
        #loginPage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }
        
        /* 确保登录页面内容始终居中 */
        #loginPage > div {
            margin: auto;
            max-height: 100vh;
            overflow-y: auto;
        }
    </style>
</head>
<body class="bg-gray-50" style="margin: 0; padding: 0; overflow-x: hidden;">
    <!-- 登录页面 -->
    <div id="loginPage" class="bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
        <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">智"惠"民生</h1>
                <p class="text-gray-600">基于MCP的政务服务平台</p>
            </div>

            <!-- 登录类型切换 -->
            <div class="flex bg-gray-100 rounded-lg p-1 mb-6">
                <button id="normalLogin" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors bg-white text-blue-600 shadow-sm">
                    普通用户登录
                </button>
                <button id="governmentLogin" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900">
                    政务人员登录
                </button>
            </div>

            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2" id="nameLabel">姓名</label>
                    <input type="text" id="nameInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入您的姓名" required>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">手机号码</label>
                    <input type="tel" id="phoneInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入手机号码" required>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">身份证号</label>
                    <input type="text" id="idCardInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入身份证号码" required>
                </div>

                <!-- 政务人员部门选择 -->
                <div id="departmentSelect" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">所属部门</label>
                    <select id="departmentInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">请选择部门</option>
                        <option value="民政局">民政局</option>
                        <option value="公安局">公安局</option>
                        <option value="市场监督管理局">市场监督管理局</option>
                        <option value="人力资源和社会保障局">人力资源和社会保障局</option>
                        <option value="卫生健康委员会">卫生健康委员会</option>
                        <option value="教育局">教育局</option>
                        <option value="交通局">交通局</option>
                        <option value="税务局">税务局</option>
                    </select>
                </div>

                <button type="submit" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                    登录
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-sm text-gray-600" id="loginNote">登录即表示同意用户协议和隐私政策</p>
            </div>
        </div>
    </div>

    <!-- 主应用页面 -->
    <div id="mainApp" class="min-h-screen bg-gray-50" style="display: none; margin: 0; padding: 0;">
        <!-- 内容区域 -->
        <div class="pb-32">
            <!-- 首页 -->
            <div id="homeTab" class="tab-content active">
                <div class="bg-white shadow-sm">
                    <div class="px-4 py-6">
                                                    <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h1 class="text-2xl font-bold text-gray-900" id="userGreeting">您好，用户</h1>
                                    <div class="flex items-center">
                                        <p class="text-gray-600 text-sm" id="userLocation">北京市 · 朝阳区</p>
                                        <button onclick="showLocationSelector()" class="ml-2 text-blue-600 text-sm hover:text-blue-800">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </div>
                                </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                <span class="text-blue-600 font-semibold text-lg" id="userAvatar">用</span>
                            </div>
                        </div>

                        <!-- 搜索框 -->
                        <div class="relative">
                            <div class="relative">
                                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                <input type="text" id="searchInput" class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="搜索要办理的事务...">
                            </div>
                        </div>

                        <!-- 搜索按钮 -->
                        <button onclick="handleSearch()" class="w-full mt-3 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors">
                            搜索
                        </button>
                    </div>
                </div>

                <!-- 常见事务 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">常见事务</h2>
                    <div class="grid grid-cols-2 gap-4" id="commonTransactions">
                        <!-- 事务卡片将通过JavaScript动态生成 -->
                    </div>
                </div>

                <!-- 快速入口 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">快速入口</h2>
                    <div class="grid grid-cols-5 gap-4">
                        <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center mb-2 bg-blue-100">
                                <span class="text-xl">📋</span>
                            </div>
                            <span class="text-xs text-gray-700">办事指南</span>
                        </div>
                        <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center mb-2 bg-green-100">
                                <span class="text-xl">📍</span>
                            </div>
                            <span class="text-xs text-gray-700">附近网点</span>
                        </div>
                        <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center mb-2 bg-purple-100">
                                <span class="text-xl">📞</span>
                            </div>
                            <span class="text-xs text-gray-700">在线咨询</span>
                        </div>
                        <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center mb-2 bg-orange-100">
                                <span class="text-xl">📱</span>
                            </div>
                            <span class="text-xs text-gray-700">进度查询</span>
                        </div>
                        <div class="flex flex-col items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="showFeedbackModal()">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center mb-2 bg-purple-100">
                                <span class="text-xl">💬</span>
                            </div>
                            <span class="text-xs text-gray-700">意见反馈</span>
                        </div>
                    </div>
                </div>

                <!-- 最新动态 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">最新动态</h2>
                    <div class="space-y-4">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">📢</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-medium text-gray-900 text-sm">系统维护通知</h3>
                                    <p class="text-gray-600 text-xs mt-1">系统将于今晚22:00-24:00进行维护，期间部分功能可能无法使用</p>
                                    <span class="text-gray-400 text-xs">2小时前</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-green-600 text-sm">✅</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-medium text-gray-900 text-sm">新功能上线</h3>
                                    <p class="text-gray-600 text-xs mt-1">身份证办理在线预约功能已上线，支持提前预约办理时间</p>
                                    <span class="text-gray-400 text-xs">1天前</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-start">
                                <div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-orange-600 text-sm">📋</span>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-medium text-gray-900 text-sm">政策更新</h3>
                                    <p class="text-gray-600 text-xs mt-1">《关于进一步优化营商环境的实施意见》已发布</p>
                                    <span class="text-gray-400 text-xs">3天前</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 便民服务 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">便民服务</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">🏥</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">医疗健康</h3>
                            </div>
                            <p class="text-gray-600 text-xs">预约挂号、健康档案查询</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-green-600 text-sm">🎓</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">教育服务</h3>
                            </div>
                            <p class="text-gray-600 text-xs">学籍查询、教育缴费</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-purple-600 text-sm">🏠</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">住房服务</h3>
                            </div>
                            <p class="text-gray-600 text-xs">房产查询、公积金服务</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-orange-600 text-sm">🚗</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">交通出行</h3>
                            </div>
                            <p class="text-gray-600 text-xs">违章查询、公交查询</p>
                        </div>
                    </div>
                </div>

                <!-- 底部间距 -->
                <div class="h-8"></div>
            </div>

            <!-- 事务页面 -->
            <div id="transactionsTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">我的事务</h1>
                    <p class="text-gray-600">查看您正在办理的事务进度</p>
                </div>

                <div class="px-4 py-6">
                    <div class="space-y-4" id="transactionsList">
                        <!-- 事务列表将通过JavaScript动态生成 -->
                    </div>
                </div>

                <!-- 事务统计 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">事务统计</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-600">本月办理</p>
                                    <p class="text-2xl font-bold text-blue-600">12</p>
                                </div>
                                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                    <span class="text-blue-600 text-xl">📊</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm text-gray-600">平均用时</p>
                                    <p class="text-2xl font-bold text-green-600">3.2天</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                    <span class="text-green-600 text-xl">⏱️</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 办理指南 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">办理指南</h2>
                    <div class="space-y-3">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">1</span>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">准备材料</h3>
                                    <p class="text-gray-600 text-xs">根据办理事项准备所需材料</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">2</span>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">在线预约</h3>
                                    <p class="text-gray-600 text-xs">选择合适的时间进行预约</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">3</span>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">现场办理</h3>
                                    <p class="text-gray-600 text-xs">按时到达指定地点办理</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">4</span>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">进度查询</h3>
                                    <p class="text-gray-600 text-xs">实时查看办理进度</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 底部间距 -->
                <div class="h-8"></div>
            </div>

            <!-- 政策页面 -->
            <div id="policiesTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">政策解读</h1>
                    <p class="text-gray-600">了解最新政策动态和解读</p>
                </div>

                <!-- 分类筛选 -->
                <div class="px-4 py-4 bg-white border-b border-gray-200">
                    <div class="flex space-x-2 overflow-x-auto" id="policyFilters">
                        <!-- 筛选按钮将通过JavaScript动态生成 -->
                    </div>
                </div>

                <div class="px-4 py-6">
                    <div class="space-y-4" id="policiesList">
                        <!-- 政策列表将通过JavaScript动态生成 -->
                    </div>
                </div>

                <!-- 政策解读服务 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">政策解读服务</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-blue-600 text-sm">📞</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">在线咨询</h3>
                            </div>
                            <p class="text-gray-600 text-xs">专业政策解读咨询服务</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-green-600 text-sm">📋</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">政策申请</h3>
                            </div>
                            <p class="text-gray-600 text-xs">政策相关业务申请</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-purple-600 text-sm">📊</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">政策分析</h3>
                            </div>
                            <p class="text-gray-600 text-xs">政策影响分析报告</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-orange-600 text-sm">📈</span>
                                </div>
                                <h3 class="font-medium text-gray-900 text-sm">政策追踪</h3>
                            </div>
                            <p class="text-gray-600 text-xs">政策执行情况追踪</p>
                        </div>
                    </div>
                </div>

                <!-- 政策日历 -->
                <div class="px-4 py-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">政策日历</h2>
                    <div class="space-y-3">
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">营商环境优化月</h3>
                                    <p class="text-gray-600 text-xs">2024年3月1日 - 3月31日</p>
                                </div>
                                <span class="px-2 py-1 bg-blue-100 text-blue-600 text-xs rounded-full">进行中</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">便民服务周</h3>
                                    <p class="text-gray-600 text-xs">2024年3月15日 - 3月21日</p>
                                </div>
                                <span class="px-2 py-1 bg-green-100 text-green-600 text-xs rounded-full">即将开始</span>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-medium text-gray-900 text-sm">政策宣讲会</h3>
                                    <p class="text-gray-600 text-xs">2024年3月25日 14:00-16:00</p>
                                </div>
                                <span class="px-2 py-1 bg-orange-100 text-orange-600 text-xs rounded-full">报名中</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 底部间距 -->
                <div class="h-8"></div>
            </div>

            <!-- 政务人员待办事项页面 -->
            <div id="todoTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">待办事项</h1>
                    <p class="text-gray-600">处理需要您审批和办理的事项</p>
                </div>

                <!-- 统计卡片 -->
                <div class="px-4 py-6">
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600" id="urgentCount">5</div>
                            <div class="text-sm text-gray-600">紧急待办</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-orange-600" id="pendingCount">12</div>
                            <div class="text-sm text-gray-600">待审批</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-green-600" id="completedCount">28</div>
                            <div class="text-sm text-gray-600">已完成</div>
                        </div>
                    </div>

                    <!-- 筛选选项 -->
                    <div class="flex space-x-2 overflow-x-auto mb-4" id="todoFilters">
                        <button class="filter-btn active px-4 py-2 bg-blue-600 text-white rounded-lg text-sm whitespace-nowrap">全部</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">紧急</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">待审批</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">已处理</button>
                    </div>

                    <div class="space-y-4" id="todoList">
                        <!-- 待办事项列表将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 政务人员政策解读页面 -->
            <div id="policyInterpretationTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">政策解读</h1>
                    <p class="text-gray-600">为市民提供政策解读和咨询服务</p>
                </div>

                <!-- 快速操作 -->
                <div class="px-4 py-6">
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center cursor-pointer hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2">
                                <i class="fas fa-plus text-blue-600 text-xl"></i>
                            </div>
                            <div class="text-sm font-medium text-gray-900">发布解读</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center cursor-pointer hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2">
                                <i class="fas fa-edit text-green-600 text-xl"></i>
                            </div>
                            <div class="text-sm font-medium text-gray-900">编辑解读</div>
                        </div>
                    </div>

                    <!-- 解读列表 -->
                    <div class="space-y-4" id="interpretationList">
                        <!-- 政策解读列表将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 政务人员群众反馈页面 -->
            <div id="feedbackTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <h1 class="text-2xl font-bold text-gray-900 mb-2">群众反馈</h1>
                    <p class="text-gray-600">查看和处理群众提交的反馈意见</p>
                </div>

                <!-- 统计信息 -->
                <div class="px-4 py-6">
                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-red-600" id="newFeedbackCount">8</div>
                            <div class="text-sm text-gray-600">新反馈</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-yellow-600" id="processingFeedbackCount">15</div>
                            <div class="text-sm text-gray-600">处理中</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-green-600" id="resolvedFeedbackCount">42</div>
                            <div class="text-sm text-gray-600">已解决</div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm p-4 text-center">
                            <div class="text-2xl font-bold text-blue-600" id="totalFeedbackCount">65</div>
                            <div class="text-sm text-gray-600">总反馈</div>
                        </div>
                    </div>

                    <!-- AI总结卡片 -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-6 border border-blue-200">
                        <div class="flex items-center mb-3">
                            <i class="fas fa-robot text-blue-600 mr-2"></i>
                            <h3 class="font-medium text-gray-900">AI反馈总结</h3>
                        </div>
                        
                        <!-- 数据可视化图表 -->
                        <div class="grid grid-cols-1 gap-4 mb-4">
                            
                            <!-- 处理效率条形图 -->
                            <div class="bg-white rounded-lg p-3">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">处理效率</h4>
                                <div class="space-y-2">
                                    <div class="flex items-center justify-between text-xs">
                                        <span>新反馈</span>
                                        <div class="flex items-center">
                                            <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                                <div id="newProgress" class="bg-blue-500 h-2 rounded-full" style="width: 30%"></div>
                                            </div>
                                            <span id="newCount">0</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between text-xs">
                                        <span>处理中</span>
                                        <div class="flex items-center">
                                            <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                                <div id="processingProgress" class="bg-yellow-500 h-2 rounded-full" style="width: 25%"></div>
                                            </div>
                                            <span id="processingCount">0</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between text-xs">
                                        <span>已解决</span>
                                        <div class="flex items-center">
                                            <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                                <div id="resolvedProgress" class="bg-green-500 h-2 rounded-full" style="width: 45%"></div>
                                            </div>
                                            <span id="resolvedCount">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 时间趋势分析 -->
                        <div class="bg-white rounded-lg p-3 mb-4">
                            <h4 class="text-sm font-medium text-gray-700 mb-2">时间趋势分析</h4>
                            <div class="grid grid-cols-4 gap-2 text-xs">
                                <div class="text-center">
                                    <div class="text-lg font-bold text-blue-600" id="todayCount">0</div>
                                    <div class="text-gray-500">今日</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-lg font-bold text-green-600" id="weekCount">0</div>
                                    <div class="text-gray-500">本周</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-lg font-bold text-orange-600" id="monthCount">0</div>
                                    <div class="text-gray-500">本月</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-lg font-bold text-purple-600" id="totalCount">0</div>
                                    <div class="text-gray-500">总计</div>
                                </div>
                            </div>
                            <div class="mt-2 text-xs text-gray-600" id="trendAnalysis">
                                反馈量呈上升趋势，用户参与度持续提升
                            </div>
                        </div>
                        </div>
                        
                        <!-- 智能建议卡片 -->
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 mb-4 border border-green-200">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-lightbulb text-green-600 mr-2"></i>
                                <h4 class="font-medium text-gray-900">智能建议</h4>
                            </div>
                            <div class="space-y-2 text-sm" id="smartSuggestions">
                                <div class="flex items-start">
                                    <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-2 flex-shrink-0"></div>
                                    <span id="suggestion1">优化朝阳区服务窗口人员配置，增加服务人员数量</span>
                                </div>
                                <div class="flex items-start">
                                    <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-2 flex-shrink-0"></div>
                                    <span id="suggestion2">简化社保办理流程，减少不必要的材料要求</span>
                                </div>
                                <div class="flex items-start">
                                    <div class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-2 flex-shrink-0"></div>
                                    <span id="suggestion3">完善在线预约系统，提供更便捷的网上服务</span>
                                </div>
                                <div class="flex items-start">
                                    <div class="w-2 h-2 bg-orange-500 rounded-full mt-2 mr-2 flex-shrink-0"></div>
                                    <span id="suggestion4">加强工作人员培训，提升服务态度和专业水平</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-sm text-gray-700" id="aiSummary">
                            <div class="mb-2">
                                <strong>热门话题：</strong>
                                <span id="hotTopics">办理流程优化、服务态度改善、材料简化</span>
                            </div>
                            <div class="mb-2">
                                <strong>平均字数：</strong>
                                <span id="avgWordCount">72字</span>
                            </div>
                            <div class="mb-2">
                                <strong>反馈趋势：</strong>
                                <span id="feedbackTrend">本周反馈量较上周增长15%，满意度提升8%</span>
                            </div>
                            <div class="mb-2">
                                <strong>处理效率：</strong>
                                <span id="processingEfficiency">平均处理时间2.3天，响应速度良好</span>
                            </div>
                            <div class="mb-2">
                                <strong>问题分类：</strong>
                                <span id="issueCategories">流程问题(35%)、服务态度(25%)、材料要求(20%)、系统功能(15%)、其他(5%)</span>
                            </div>
                            <div class="mb-2">
                                <strong>用户满意度：</strong>
                                <span id="userSatisfaction">整体满意度4.2/5.0，较上月提升0.3分</span>
                            </div>
                            <div class="mb-2">
                                <strong>改进建议：</strong>
                                <span id="prioritySuggestions">优化办理流程、增加网上预约、统一材料标准</span>
                            </div>
                            <div class="mb-2">
                                <strong>重点关注：</strong>
                                <span id="focusAreas">朝阳区服务窗口、社保办理流程、在线预约系统</span>
                            </div>
                            <div class="mb-2">
                                <strong>预期效果：</strong>
                                <span id="expectedOutcomes">实施建议后预计满意度提升15%，处理效率提升25%</span>
                            </div>
                            <div class="mb-2">
                                <strong>关键洞察：</strong>
                                <span id="keyInsights">用户对在线服务需求增长，窗口服务效率有待提升，材料简化呼声较高</span>
                            </div>
                            <div class="mb-2">
                                <strong>风险预警：</strong>
                                <span id="riskWarnings">负面反馈集中在流程复杂环节，需重点关注朝阳区服务窗口</span>
                            </div>
                            <div>
                                <strong>改进优先级：</strong>
                                <span id="improvementPriority">1.简化办理流程 2.提升窗口服务 3.完善在线系统 4.统一材料标准</span>
                            </div>
                        </div>
                    </div>

                    <!-- 筛选选项 -->
                    <div class="flex space-x-2 overflow-x-auto mb-4" id="feedbackFilters">
                        <button class="filter-btn active px-4 py-2 bg-blue-600 text-white rounded-lg text-sm whitespace-nowrap">全部</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">新反馈</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">处理中</button>
                        <button class="filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap">已解决</button>
                    </div>

                    <div class="space-y-4" id="feedbackList">
                        <!-- 反馈列表将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 个人中心页面 -->
            <div id="profileTab" class="tab-content">
                <div class="bg-white shadow-sm px-4 py-6">
                    <div class="flex items-center mb-6">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-blue-600 font-semibold text-xl" id="profileAvatar">用</span>
                        </div>
                        <div class="flex-1">
                            <h1 class="text-xl font-bold text-gray-900 mb-1" id="profileName">用户名</h1>
                            <div class="flex items-center text-sm text-gray-600 mb-1">
                                <i class="fas fa-user mr-1"></i>
                                <span id="profileType">普通用户</span>
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i class="fas fa-map-marker-alt mr-1"></i>
                                <span id="profileLocation">北京市 · 朝阳区</span>
                            </div>
                        </div>
                    </div>

                    <!-- 用户详细信息 -->
                    <div class="space-y-3">
                        <div class="flex items-center justify-between py-2 border-b border-gray-100">
                            <div class="flex items-center">
                                <i class="fas fa-phone text-gray-400 mr-3"></i>
                                <span class="text-gray-700">手机号码</span>
                            </div>
                            <span class="text-gray-900" id="profilePhone">138****8888</span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b border-gray-100">
                            <div class="flex items-center">
                                <i class="fas fa-id-card text-gray-400 mr-3"></i>
                                <span class="text-gray-700">身份证号</span>
                            </div>
                            <span class="text-gray-900" id="profileIdCard">110***********8888</span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b border-gray-100" id="profileDepartmentContainer" style="display: none;">
                            <div class="flex items-center">
                                <i class="fas fa-building text-gray-400 mr-3"></i>
                                <span class="text-gray-700">所属部门</span>
                            </div>
                            <span class="text-gray-900" id="profileDepartment">民政局</span>
                        </div>
                    </div>
                </div>

                <!-- 功能菜单 -->
                <div class="px-4 py-6">
                    <div class="bg-white rounded-lg shadow-sm">
                        <div class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors">
                            <div class="flex items-center">
                                <i class="fas fa-cog text-gray-400 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">设置</div>
                                    <div class="text-sm text-gray-500">账户设置、通知设置等</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                        <div class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors">
                            <div class="flex items-center">
                                <i class="fas fa-shield-alt text-gray-400 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">隐私安全</div>
                                    <div class="text-sm text-gray-500">隐私设置、安全设置</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                        <div class="w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors">
                            <div class="flex items-center">
                                <i class="fas fa-question-circle text-gray-400 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">帮助中心</div>
                                    <div class="text-sm text-gray-500">常见问题、联系客服</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                        <div class="w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors cursor-pointer" onclick="showFeedbackModal()">
                            <div class="flex items-center">
                                <i class="fas fa-comment-dots text-blue-500 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">意见反馈</div>
                                    <div class="text-sm text-gray-500">提交建议、报告问题</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>
                </div>

                <!-- 特殊功能 -->
                <div class="px-4 py-6">
                    <div class="bg-white rounded-lg shadow-sm">
                        <!-- 普通用户切换到政务人员 -->
                        <div id="switchToGovernment" class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer" onclick="switchToGovernmentMode()">
                            <div class="flex items-center">
                                <i class="fas fa-building text-blue-500 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">切换为政务人员</div>
                                    <div class="text-sm text-gray-500">切换到政务人员登录模式</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                        
                        <!-- 政务人员切换到普通用户 -->
                        <div id="switchToNormal" class="w-full flex items-center justify-between p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer" onclick="switchToNormalMode()" style="display: none;">
                            <div class="flex items-center">
                                <i class="fas fa-user text-green-500 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-gray-900">切换为普通用户</div>
                                    <div class="text-sm text-gray-500">切换到普通用户登录模式</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                        
                        <div class="w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors cursor-pointer" onclick="showLogoutConfirm()">
                            <div class="flex items-center">
                                <i class="fas fa-sign-out-alt text-red-500 mr-3"></i>
                                <div class="text-left">
                                    <div class="font-medium text-red-600">退出登录</div>
                                    <div class="text-sm text-gray-500">退出当前账户</div>
                                </div>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>
                </div>

                <!-- 底部间距 -->
                <div class="h-32"></div>
            </div>

            <!-- 事务详情页面 -->
            <div id="transactionDetailTab" class="tab-content">
                <div class="bg-white shadow-sm p-4">
                    <button onclick="backToHome()" class="flex items-center text-blue-600 mb-4">
                        <i class="fas fa-arrow-left mr-2"></i>
                        <span>返回</span>
                    </button>
                    <div id="transactionDetailContent">
                        <!-- 事务详情内容将通过JavaScript动态生成 -->
                    </div>
                </div>
                <!-- 底部间距 -->
                <div class="h-50"></div>
            </div>
        </div>

        <!-- 底部导航 -->
        <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2">
            <div class="flex justify-around" id="bottomNavigation">
                <!-- 普通用户导航 -->
                <div class="flex justify-around w-full" id="normalUserNav" style="display: none;">
                    <button onclick="switchTab('home')" class="nav-item active flex flex-col items-center py-2 px-3 rounded-lg transition-colors">
                        <i class="fas fa-home text-lg"></i>
                        <span class="text-xs mt-1">首页</span>
                    </button>
                    <button onclick="switchTab('transactions')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-file-alt text-lg"></i>
                        <span class="text-xs mt-1">事务</span>
                    </button>
                    <button onclick="switchTab('policies')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-book-open text-lg"></i>
                        <span class="text-xs mt-1">政策</span>
                    </button>
                    <button onclick="switchTab('profile')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-user text-lg"></i>
                        <span class="text-xs mt-1">我的</span>
                    </button>
                </div>
                
                <!-- 政务人员导航 -->
                <div class="flex justify-around w-full" id="governmentUserNav" style="display: none;">
                    <button onclick="switchTab('todo')" class="nav-item active flex flex-col items-center py-2 px-3 rounded-lg transition-colors">
                        <i class="fas fa-tasks text-lg"></i>
                        <span class="text-xs mt-1">待办事项</span>
                    </button>
                    <button onclick="switchTab('policyInterpretation')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-book-open text-lg"></i>
                        <span class="text-xs mt-1">政策解读</span>
                    </button>
                    <button onclick="switchTab('feedback')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-comments text-lg"></i>
                        <span class="text-xs mt-1">群众反馈</span>
                    </button>
                    <button onclick="switchTab('profile')" class="nav-item flex flex-col items-center py-2 px-3 rounded-lg transition-colors text-gray-600 hover:text-gray-900">
                        <i class="fas fa-user text-lg"></i>
                        <span class="text-xs mt-1">我的</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框 -->
    <div id="modal" class="modal">
        <div class="bg-white rounded-lg max-w-md w-full max-h-[80vh] overflow-y-auto mx-4">
            <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-900" id="modalTitle">详情</h2>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="modalContent">
                    <!-- 模态框内容将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 地址选择器模态框 -->
    <div id="locationModal" class="modal">
        <div class="bg-white rounded-lg max-w-md w-full max-h-[80vh] overflow-y-auto mx-4">
            <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-900">选择地址</h2>
                    <button onclick="closeLocationModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="locationModalContent">
                    <!-- 地址选择器内容 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局状态
        let currentUser = null;
        let currentTab = 'home';
        let loginType = 'normal';

        // 部门相关的事务数据
        const departmentTransactions = {
            '民政局': [
                {
                    id: 'marriage-1',
                    title: '结婚登记',
                    description: '办理结婚证书服务',
                    type: '结婚登记',
                    estimatedTime: '当场办理，约30分钟',
                    requiredDocuments: ['身份证', '户口本', '照片', '未婚证明'],
                    department: '民政局'
                },
                {
                    id: 'divorce-1',
                    title: '离婚登记',
                    description: '办理离婚证书服务',
                    type: '离婚登记',
                    estimatedTime: '当场办理，约30分钟',
                    requiredDocuments: ['身份证', '户口本', '结婚证', '离婚协议'],
                    department: '民政局'
                },
                {
                    id: 'adoption-1',
                    title: '收养登记',
                    description: '办理收养登记服务',
                    type: '收养登记',
                    estimatedTime: '5个工作日',
                    requiredDocuments: ['身份证', '户口本', '收养协议', '体检证明'],
                    department: '民政局'
                }
            ],
            '公安局': [
                {
                    id: 'idcard-1',
                    title: '身份证办理',
                    description: '居民身份证申领、换领、补领服务',
                    type: '身份证',
                    estimatedTime: '7个工作日',
                    requiredDocuments: ['户口本', '照片'],
                    department: '公安局'
                },
                {
                    id: 'passport-1',
                    title: '护照办理',
                    description: '普通护照申领服务',
                    type: '护照',
                    estimatedTime: '10个工作日',
                    requiredDocuments: ['身份证', '户口本', '照片'],
                    department: '公安局'
                },
                {
                    id: 'visa-1',
                    title: '签证办理',
                    description: '各类签证申请服务',
                    type: '签证',
                    estimatedTime: '15个工作日',
                    requiredDocuments: ['护照', '身份证', '申请表'],
                    department: '公安局'
                }
            ],
            '市场监督管理局': [
                {
                    id: 'business-1',
                    title: '营业执照办理',
                    description: '工商营业执照申领服务',
                    type: '营业执照',
                    estimatedTime: '3-5个工作日',
                    requiredDocuments: ['身份证', '场地证明', '公司章程'],
                    department: '市场监督管理局'
                },
                {
                    id: 'food-1',
                    title: '食品经营许可证',
                    description: '食品经营许可证申请',
                    type: '食品经营许可证',
                    estimatedTime: '10个工作日',
                    requiredDocuments: ['营业执照', '场地证明', '健康证'],
                    department: '市场监督管理局'
                }
            ],
            '人力资源和社会保障局': [
                {
                    id: 'social-1',
                    title: '社保卡办理',
                    description: '社会保障卡申领服务',
                    type: '社保卡',
                    estimatedTime: '15-20个工作日',
                    requiredDocuments: ['身份证', '照片'],
                    department: '人力资源和社会保障局'
                },
                {
                    id: 'pension-1',
                    title: '养老金申领',
                    description: '退休养老金申领服务',
                    type: '养老金',
                    estimatedTime: '5个工作日',
                    requiredDocuments: ['身份证', '退休证', '银行卡'],
                    department: '人力资源和社会保障局'
                }
            ],
            '卫生健康委员会': [
                {
                    id: 'birth-1',
                    title: '出生证明',
                    description: '新生儿出生医学证明',
                    type: '出生证明',
                    estimatedTime: '1个工作日',
                    requiredDocuments: ['父母身份证', '结婚证', '医院证明'],
                    department: '卫生健康委员会'
                },
                {
                    id: 'medical-1',
                    title: '医疗机构执业许可证',
                    description: '医疗机构执业许可证申请',
                    type: '医疗机构执业许可证',
                    estimatedTime: '20个工作日',
                    requiredDocuments: ['营业执照', '场地证明', '人员资质'],
                    department: '卫生健康委员会'
                }
            ],
            '教育局': [
                {
                    id: 'school-1',
                    title: '学校办学许可证',
                    description: '民办学校办学许可证申请',
                    type: '办学许可证',
                    estimatedTime: '30个工作日',
                    requiredDocuments: ['场地证明', '师资证明', '资金证明'],
                    department: '教育局'
                }
            ],
            '交通局': [
                {
                    id: 'license-1',
                    title: '驾驶证办理',
                    description: '机动车驾驶证申领服务',
                    type: '驾驶证',
                    estimatedTime: '15-30个工作日',
                    requiredDocuments: ['身份证', '体检报告', '照片'],
                    department: '交通局'
                },
                {
                    id: 'vehicle-1',
                    title: '车辆登记',
                    description: '机动车登记服务',
                    type: '车辆登记',
                    estimatedTime: '1个工作日',
                    requiredDocuments: ['身份证', '购车发票', '保险单'],
                    department: '交通局'
                }
            ],
            '税务局': [
                {
                    id: 'tax-1',
                    title: '税务登记',
                    description: '企业税务登记服务',
                    type: '税务登记',
                    estimatedTime: '3个工作日',
                    requiredDocuments: ['营业执照', '身份证', '场地证明'],
                    department: '税务局'
                }
            ]
        };

        // 部门相关的政策数据
        const departmentPolicies = {
            '民政局': [
                {
                    id: 'marriage-policy-1',
                    title: '2025年婚姻登记数字化服务规范',
                    description: '推进婚姻登记数字化转型，提升服务效率',
                    category: '数字化服务',
                    publishDate: '2025-01-15',
                    department: '民政局',
                    content: '本规范旨在推进婚姻登记数字化转型，提升服务效率和质量...'
                },
                {
                    id: 'adoption-policy-1',
                    title: '2025年收养登记智慧化管理办法',
                    description: '运用智慧化手段优化收养登记流程',
                    category: '智慧化管理',
                    publishDate: '2025-01-10',
                    department: '民政局',
                    content: '本办法运用智慧化手段优化收养登记流程，提升服务质量...'
                }
            ],
            '公安局': [
                {
                    id: 'idcard-policy-1',
                    title: '2025年居民身份证智能化管理条例',
                    description: '推进身份证办理智能化，提升便民服务水平',
                    category: '智能化管理',
                    publishDate: '2025-01-20',
                    department: '公安局',
                    content: '本条例推进身份证办理智能化，提升便民服务水平...'
                }
            ],
            '市场监督管理局': [
                {
                    id: 'business-policy-1',
                    title: '2025年市场主体数字化登记管理条例',
                    description: '推进市场主体登记数字化转型',
                    category: '数字化登记',
                    publishDate: '2025-01-18',
                    department: '市场监督管理局',
                    content: '本条例推进市场主体登记数字化转型，提升登记效率...'
                }
            ],
            '人力资源和社会保障局': [
                {
                    id: 'social-policy-1',
                    title: '2025年社会保险数字化服务条例',
                    description: '推进社会保险服务数字化转型',
                    category: '数字化服务',
                    publishDate: '2025-01-12',
                    department: '人力资源和社会保障局',
                    content: '本条例推进社会保险服务数字化转型，提升服务体验...'
                }
            ],
            '卫生健康委员会': [
                {
                    id: 'health-policy-1',
                    title: '2025年智慧医疗服务管理条例',
                    description: '推进医疗服务智慧化发展',
                    category: '智慧医疗',
                    publishDate: '2025-01-16',
                    department: '卫生健康委员会',
                    content: '本条例推进医疗服务智慧化发展，提升医疗服务质量...'
                }
            ],
            '教育局': [
                {
                    id: 'education-policy-1',
                    title: '2025年智慧教育发展促进条例',
                    description: '推进教育数字化转型，促进智慧教育发展',
                    category: '智慧教育',
                    publishDate: '2025-01-14',
                    department: '教育局',
                    content: '本条例推进教育数字化转型，促进智慧教育发展...'
                }
            ],
            '交通局': [
                {
                    id: 'traffic-policy-1',
                    title: '2025年智慧交通管理服务条例',
                    description: '推进交通管理智慧化，提升出行体验',
                    category: '智慧交通',
                    publishDate: '2025-01-17',
                    department: '交通局',
                    content: '本条例推进交通管理智慧化，提升市民出行体验...'
                }
            ],
            '税务局': [
                {
                    id: 'tax-policy-1',
                    title: '2025年智慧税务服务管理条例',
                    description: '推进税务服务智慧化，优化营商环境',
                    category: '智慧税务',
                    publishDate: '2025-01-19',
                    department: '税务局',
                    content: '本条例推进税务服务智慧化，优化营商环境...'
                }
            ]
        };

        // 模拟数据
        const commonTransactions = [
            {
                id: '1',
                title: '身份证办理',
                description: '新办、换领、补领身份证',
                icon: '🆔',
                category: '证件办理',
                estimatedTime: '5个工作日',
                requiredDocuments: ['户口本', '照片']
            },
            {
                id: '2',
                title: '营业执照',
                description: '个体工商户营业执照申请',
                icon: '🏢',
                category: '工商注册',
                estimatedTime: '10个工作日',
                requiredDocuments: ['身份证', '经营场所证明', '申请表']
            },
            {
                id: '3',
                title: '社保卡办理',
                description: '社会保障卡新办、补办',
                icon: '💳',
                category: '社会保障',
                estimatedTime: '3个工作日',
                requiredDocuments: ['身份证', '照片']
            },
            {
                id: '4',
                title: '驾驶证办理',
                description: '机动车驾驶证申请',
                icon: '🚗',
                category: '交通出行',
                estimatedTime: '7个工作日',
                requiredDocuments: ['身份证', '体检证明', '照片']
            },
            {
                id: '5',
                title: '结婚登记',
                description: '结婚证办理',
                icon: '💒',
                category: '婚姻登记',
                estimatedTime: '1个工作日',
                requiredDocuments: ['身份证', '户口本', '未婚证明']
            },
            {
                id: '6',
                title: '出生证明',
                description: '新生儿出生医学证明',
                icon: '👶',
                category: '医疗卫生',
                estimatedTime: '1个工作日',
                requiredDocuments: ['父母身份证', '结婚证', '医院证明']
            }
        ];

        const transactions = [
            {
                id: '1',
                title: '身份证办理',
                description: '新办身份证业务',
                status: 'processing',
                type: '身份证',
                createdAt: '2024-01-15',
                updatedAt: '2024-01-16',
                location: '市民服务中心',
                estimatedTime: '5个工作日',
                requiredDocuments: ['户口本', '照片'],
                steps: [
                    {
                        id: '1-1',
                        title: '提交申请',
                        description: '携带相关证件到窗口提交申请',
                        status: 'completed',
                        order: 1,
                        location: '市民服务中心1楼',
                        estimatedTime: '30分钟',
                        requiredDocuments: ['户口本', '照片']
                    },
                    {
                        id: '1-2',
                        title: '信息审核',
                        description: '工作人员审核信息',
                        status: 'current',
                        order: 2,
                        location: '市民服务中心2楼',
                        estimatedTime: '2个工作日',
                        requiredDocuments: []
                    },
                    {
                        id: '1-3',
                        title: '制证完成',
                        description: '身份证制作完成，可领取',
                        status: 'pending',
                        order: 3,
                        location: '市民服务中心1楼',
                        estimatedTime: '3个工作日',
                        requiredDocuments: ['领取凭证']
                    }
                ]
            },
            {
                id: '2',
                title: '营业执照办理',
                description: '个体工商户营业执照申请',
                status: 'pending',
                type: '营业执照',
                createdAt: '2024-01-10',
                updatedAt: '2024-01-10',
                location: '市场监督管理局',
                estimatedTime: '10个工作日',
                requiredDocuments: ['身份证', '经营场所证明', '申请表'],
                steps: [
                    {
                        id: '2-1',
                        title: '提交材料',
                        description: '提交营业执照申请材料',
                        status: 'completed',
                        order: 1,
                        location: '市场监督管理局窗口',
                        estimatedTime: '1小时',
                        requiredDocuments: ['身份证', '经营场所证明', '申请表']
                    },
                    {
                        id: '2-2',
                        title: '材料审核',
                        description: '审核申请材料',
                        status: 'current',
                        order: 2,
                        location: '市场监督管理局',
                        estimatedTime: '5个工作日',
                        requiredDocuments: []
                    },
                    {
                        id: '2-3',
                        title: '现场核查',
                        description: '对经营场所进行现场核查',
                        status: 'pending',
                        order: 3,
                        location: '经营场所',
                        estimatedTime: '1个工作日',
                        requiredDocuments: []
                    },
                    {
                        id: '2-4',
                        title: '审批通过',
                        description: '审批通过，发放营业执照',
                        status: 'pending',
                        order: 4,
                        location: '市场监督管理局窗口',
                        estimatedTime: '3个工作日',
                        requiredDocuments: ['领取凭证']
                    }
                ]
            }
        ];

        const policies = [
            {
                id: '1',
                title: '2025年数字经济发展行动计划',
                summary: '为抢抓数字经济发展机遇，推动经济高质量发展，制定2025年数字经济发展行动计划...',
                content: '为抢抓数字经济发展机遇，推动经济高质量发展，制定2025年数字经济发展行动计划：\n\n一、总体目标\n到2025年底，数字经济核心产业增加值占GDP比重达到15%以上...\n\n二、重点任务\n1. 加快数字基础设施建设\n2. 推进产业数字化转型\n3. 培育数字经济新业态\n4. 完善数字治理体系\n\n三、保障措施\n1. 加强组织领导\n2. 加大资金支持\n3. 强化人才保障',
                category: '数字经济',
                publishDate: '2025-01-15',
                effectiveDate: '2025-02-01',
                location: '北京市',
                tags: ['数字经济', '政策解读', '新政策'],
                author: '市政府办公厅',
                isNew: true
            },
            {
                id: '2',
                title: '2025年绿色低碳发展实施方案',
                summary: '为贯彻落实碳达峰碳中和目标，推动绿色低碳发展，制定2025年绿色低碳发展实施方案...',
                content: '为贯彻落实碳达峰碳中和目标，推动绿色低碳发展，制定2025年绿色低碳发展实施方案：\n\n一、总体要求\n以习近平生态文明思想为指导，坚持绿色发展理念...\n\n二、主要目标\n1. 单位GDP能耗下降3.5%\n2. 可再生能源消费比重达到25%\n3. 绿色建筑占新建建筑比例达到80%\n\n三、重点措施\n1. 推进能源结构优化\n2. 加快绿色技术创新\n3. 完善绿色金融体系',
                category: '绿色发展',
                publishDate: '2025-01-10',
                effectiveDate: '2025-01-15',
                location: '北京市',
                tags: ['绿色发展', '碳中和', '政策解读'],
                author: '市发展改革委',
                isNew: true
            },
            {
                id: '3',
                title: '2025年科技创新驱动发展政策',
                summary: '为加快建设国际科技创新中心，提升科技创新能力，制定2025年科技创新驱动发展政策...',
                content: '为加快建设国际科技创新中心，提升科技创新能力，制定2025年科技创新驱动发展政策：\n\n一、发展目标\n1. 全社会研发经费投入强度达到6.5%\n2. 高新技术企业数量突破3万家\n3. 技术合同成交额突破8000亿元\n\n二、重点领域\n1. 人工智能与大数据\n2. 生物医药与健康\n3. 新材料与新能源\n4. 智能制造与机器人\n\n三、支持措施\n1. 加大研发投入\n2. 完善创新生态\n3. 强化人才引进',
                category: '科技创新',
                publishDate: '2025-01-20',
                effectiveDate: '2025-02-01',
                location: '北京市',
                tags: ['科技创新', '人工智能', '政策解读'],
                author: '市科技局',
                isNew: true
            },
            {
                id: '4',
                title: '2025年智慧城市建设行动计划',
                summary: '为提升城市治理现代化水平，建设智慧城市，制定2025年智慧城市建设行动计划...',
                content: '为提升城市治理现代化水平，建设智慧城市，制定2025年智慧城市建设行动计划：\n\n一、建设目标\n1. 5G网络覆盖率达到95%\n2. 智慧政务服务水平显著提升\n3. 城市治理智能化水平明显提高\n\n二、重点工程\n1. 智慧交通系统建设\n2. 智慧医疗服务平台\n3. 智慧教育资源共享\n4. 智慧社区管理平台\n\n三、保障机制\n1. 加强组织领导\n2. 完善标准规范\n3. 强化安全保障',
                category: '智慧城市',
                publishDate: '2025-01-25',
                effectiveDate: '2025-03-01',
                location: '北京市',
                tags: ['智慧城市', '数字化转型', '政策解读'],
                author: '市经济和信息化局',
                isNew: true
            }
        ];

        // 政务人员数据
        const todoItems = [
            {
                id: '1',
                title: '身份证办理审批',
                description: '张三的身份证办理申请需要审批',
                type: '审批',
                priority: 'urgent',
                status: 'pending',
                applicant: '张三',
                createdAt: '2024-01-16',
                deadline: '2024-01-18',
                department: '公安局',
                location: '市民服务中心'
            },
            {
                id: '2',
                title: '营业执照现场核查',
                description: '李四的个体工商户营业执照申请需要现场核查',
                type: '现场核查',
                priority: 'normal',
                status: 'pending',
                applicant: '李四',
                createdAt: '2024-01-15',
                deadline: '2024-01-20',
                department: '市场监督管理局',
                location: '经营场所'
            },
            {
                id: '3',
                title: '社保卡办理审核',
                description: '王五的社保卡办理申请需要审核',
                type: '审核',
                priority: 'normal',
                status: 'processing',
                applicant: '王五',
                createdAt: '2024-01-14',
                deadline: '2024-01-17',
                department: '人力资源和社会保障局',
                location: '市民服务中心'
            },
            {
                id: '4',
                title: '结婚登记材料审核',
                description: '赵六的结婚登记申请需要材料审核',
                type: '材料审核',
                priority: 'urgent',
                status: 'completed',
                applicant: '赵六',
                createdAt: '2024-01-13',
                deadline: '2024-01-15',
                department: '民政局',
                location: '市民服务中心'
            },
            {
                id: '5',
                title: '出生证明审核',
                description: '孙七的新生儿出生证明申请需要审核',
                type: '审核',
                priority: 'normal',
                status: 'pending',
                applicant: '孙七',
                createdAt: '2024-01-17',
                deadline: '2024-01-19',
                department: '卫生健康委员会',
                location: '市民服务中心'
            },
            {
                id: '6',
                title: '驾驶证考试安排',
                description: '周八的驾驶证考试需要安排',
                type: '安排',
                priority: 'normal',
                status: 'processing',
                applicant: '周八',
                createdAt: '2024-01-16',
                deadline: '2024-01-22',
                department: '交通局',
                location: '车管所'
            },
            {
                id: '7',
                title: '税务登记审核',
                description: '吴九的企业税务登记申请需要审核',
                type: '审核',
                priority: 'urgent',
                status: 'pending',
                applicant: '吴九',
                createdAt: '2024-01-18',
                deadline: '2024-01-20',
                department: '税务局',
                location: '市民服务中心'
            },
            {
                id: '8',
                title: '学校办学许可证审核',
                description: '郑十的民办学校办学许可证申请需要审核',
                type: '审核',
                priority: 'normal',
                status: 'pending',
                applicant: '郑十',
                createdAt: '2024-01-15',
                deadline: '2024-01-25',
                department: '教育局',
                location: '市民服务中心'
            }
        ];

        const policyInterpretations = [
            {
                id: '1',
                title: '2025年数字经济发展政策解读',
                summary: '详细解读2025年数字经济发展行动计划，帮助企业和个人了解政策要点',
                content: '一、政策背景\n为抢抓数字经济发展机遇，推动经济高质量发展，市政府出台了《2025年数字经济发展行动计划》。\n\n二、主要措施\n1. 加快数字基础设施建设\n2. 推进产业数字化转型\n3. 培育数字经济新业态\n4. 完善数字治理体系\n\n三、实施时间\n本政策自2025年2月1日起实施。',
                category: '数字经济',
                publishDate: '2025-01-15',
                author: '政策解读科',
                isPublished: true,
                viewCount: 256
            },
            {
                id: '2',
                title: '2025年绿色低碳发展政策解读',
                summary: '解读2025年绿色低碳发展实施方案，助力可持续发展',
                content: '一、政策目标\n贯彻落实碳达峰碳中和目标，推动绿色低碳发展。\n\n二、支持措施\n1. 推进能源结构优化\n2. 加快绿色技术创新\n3. 完善绿色金融体系\n\n三、申请流程\n符合条件的绿色项目可向相关部门申请支持。',
                category: '绿色发展',
                publishDate: '2025-01-10',
                author: '绿色发展科',
                isPublished: true,
                viewCount: 189
            },
            {
                id: '3',
                title: '2025年科技创新政策解读',
                summary: '解读2025年科技创新驱动发展政策，助力科技企业发展',
                content: '一、政策背景\n为加快建设国际科技创新中心，提升科技创新能力，制定了《2025年科技创新驱动发展政策》。\n\n二、重点领域\n1. 人工智能与大数据\n2. 生物医药与健康\n3. 新材料与新能源\n4. 智能制造与机器人\n\n三、支持措施\n1. 加大研发投入\n2. 完善创新生态\n3. 强化人才引进',
                category: '科技创新',
                publishDate: '2025-01-20',
                author: '科技创新科',
                isPublished: true,
                viewCount: 167
            }
        ];

        const governmentFeedback = [
            // 公安局反馈
            {
                id: '1',
                title: '关于身份证办理流程的建议',
                content: '希望身份证办理流程能够更加简化，减少等待时间。目前需要排队很久，而且材料要求比较严格，希望能够优化流程，提高办理效率。建议可以增加网上预约功能，减少现场排队时间。',
                type: 'suggestion',
                status: 'new',
                submitter: '匿名用户',
                submitTime: '2024-01-16',
                contact: '138****8888',
                priority: 'normal',
                department: '公安局',
                wordCount: 89
            },
            {
                id: '2',
                title: '护照办理服务体验',
                content: '护照办理服务很好，工作人员态度专业，办理流程清晰。从预约到取证整个过程都很顺利，特别是网上预约系统很方便，节省了很多时间。希望继续保持这种服务水平。',
                type: 'praise',
                status: 'resolved',
                submitter: '张先生',
                submitTime: '2024-01-15',
                contact: '139****9999',
                priority: 'normal',
                department: '公安局',
                wordCount: 76
            },
            {
                id: '3',
                title: '户口迁移手续复杂',
                content: '户口迁移手续过于复杂，需要准备的材料太多，而且不同地区的要求还不一样。希望能够统一标准，简化流程。建议可以建立统一的办理指南，让群众少跑腿。',
                type: 'complaint',
                status: 'processing',
                submitter: '李女士',
                submitTime: '2024-01-14',
                contact: '137****7777',
                priority: 'urgent',
                department: '公安局',
                wordCount: 82
            },
            // 市场监督管理局反馈
            {
                id: '4',
                title: '营业执照办理时间过长',
                content: '营业执照办理时间过长，希望能够加快审批速度。从提交材料到拿到营业执照需要等待很长时间，影响了正常经营。建议可以优化审批流程，提高工作效率。',
                type: 'complaint',
                status: 'processing',
                submitter: '王老板',
                submitTime: '2024-01-15',
                contact: '136****6666',
                priority: 'urgent',
                department: '市场监督管理局',
                wordCount: 78
            },
            {
                id: '5',
                title: '食品经营许可证申请咨询',
                content: '申请食品经营许可证需要准备哪些材料？办理流程是怎样的？大概需要多长时间？希望能够得到详细的指导，避免重复提交材料。',
                type: 'inquiry',
                status: 'new',
                submitter: '陈店主',
                submitTime: '2024-01-16',
                contact: '135****5555',
                priority: 'normal',
                department: '市场监督管理局',
                wordCount: 65
            },
            // 人力资源和社会保障局反馈
            {
                id: '6',
                title: '社保卡办理服务很好',
                content: '社保卡办理服务很好，工作人员态度很好，办理速度快。从申请到拿到社保卡只用了很短时间，而且工作人员很耐心地解答了各种问题。希望继续保持这种服务水平。',
                type: 'praise',
                status: 'resolved',
                submitter: '刘先生',
                submitTime: '2024-01-14',
                contact: '134****4444',
                priority: 'normal',
                department: '人力资源和社会保障局',
                wordCount: 85
            },
            {
                id: '7',
                title: '养老金申领流程优化',
                content: '养老金申领流程可以进一步优化，目前需要跑多个部门，手续比较繁琐。建议可以建立一站式服务，让群众在一个地方就能办完所有手续。',
                type: 'suggestion',
                status: 'new',
                submitter: '赵大爷',
                submitTime: '2024-01-17',
                contact: '133****3333',
                priority: 'normal',
                department: '人力资源和社会保障局',
                wordCount: 72
            },
            // 民政局反馈
            {
                id: '8',
                title: '结婚登记服务体验良好',
                content: '结婚登记服务很贴心，工作人员很专业，办理流程清晰。从预约到领证整个过程都很顺利，工作人员还提供了很多有用的建议。希望继续保持这种服务水平。',
                type: 'praise',
                status: 'resolved',
                submitter: '孙先生',
                submitTime: '2024-01-13',
                contact: '132****2222',
                priority: 'normal',
                department: '民政局',
                wordCount: 81
            },
            {
                id: '9',
                title: '离婚登记材料要求',
                content: '离婚登记需要准备哪些材料？办理流程是怎样的？大概需要多长时间？希望能够得到详细的指导，避免重复提交材料。',
                type: 'inquiry',
                status: 'new',
                submitter: '周女士',
                submitTime: '2024-01-18',
                contact: '131****1111',
                priority: 'normal',
                department: '民政局',
                wordCount: 58
            },
            // 卫生健康委员会反馈
            {
                id: '10',
                title: '出生证明办理咨询',
                content: '新生儿出生证明办理需要哪些材料？希望得到详细指导。目前对办理流程不太清楚，希望能够提供详细的办理指南，避免重复跑腿。',
                type: 'inquiry',
                status: 'new',
                submitter: '吴女士',
                submitTime: '2024-01-17',
                contact: '130****0000',
                priority: 'normal',
                department: '卫生健康委员会',
                wordCount: 62
            },
            {
                id: '11',
                title: '医疗机构执业许可证申请',
                content: '申请医疗机构执业许可证需要满足哪些条件？办理流程是怎样的？大概需要多长时间？希望能够得到详细的指导。',
                type: 'inquiry',
                status: 'processing',
                submitter: '郑医生',
                submitTime: '2024-01-16',
                contact: '129****9999',
                priority: 'normal',
                department: '卫生健康委员会',
                wordCount: 55
            },
            // 交通局反馈
            {
                id: '12',
                title: '驾驶证考试安排建议',
                content: '希望驾驶证考试安排更加灵活，方便上班族参加。目前考试时间安排比较固定，对于上班族来说不太方便。建议可以增加周末和晚上的考试时间。',
                type: 'suggestion',
                status: 'processing',
                submitter: '林先生',
                submitTime: '2024-01-16',
                contact: '128****8888',
                priority: 'normal',
                department: '交通局',
                wordCount: 75
            },
            {
                id: '13',
                title: '车辆登记服务体验',
                content: '车辆登记服务很好，工作人员态度专业，办理流程清晰。从提交材料到拿到行驶证整个过程都很顺利，而且工作人员很耐心地解答了各种问题。',
                type: 'praise',
                status: 'resolved',
                submitter: '马先生',
                submitTime: '2024-01-15',
                contact: '127****7777',
                priority: 'normal',
                department: '交通局',
                wordCount: 68
            },
            // 税务局反馈
            {
                id: '14',
                title: '税务登记流程优化建议',
                content: '企业税务登记流程可以进一步简化，提高办理效率。目前需要准备的材料比较多，而且不同地区的具体要求还不一样。建议可以统一标准，简化流程。',
                type: 'suggestion',
                status: 'new',
                submitter: '钱老板',
                submitTime: '2024-01-18',
                contact: '126****6666',
                priority: 'urgent',
                department: '税务局',
                wordCount: 82
            },
            {
                id: '15',
                title: '发票申领服务咨询',
                content: '企业发票申领需要准备哪些材料？办理流程是怎样的？大概需要多长时间？希望能够得到详细的指导。',
                type: 'inquiry',
                status: 'new',
                submitter: '冯会计',
                submitTime: '2024-01-17',
                contact: '125****5555',
                priority: 'normal',
                department: '税务局',
                wordCount: 52
            },
            // 教育局反馈
            {
                id: '16',
                title: '民办学校办学许可证咨询',
                content: '申请民办学校办学许可证需要满足哪些条件？办理流程是怎样的？大概需要多长时间？希望能够得到详细的指导，避免重复提交材料。',
                type: 'inquiry',
                status: 'new',
                submitter: '黄校长',
                submitTime: '2024-01-15',
                contact: '124****4444',
                priority: 'normal',
                department: '教育局',
                wordCount: 65
            },
            {
                id: '17',
                title: '教育机构年检流程',
                content: '教育机构年检需要准备哪些材料？年检流程是怎样的？大概需要多长时间？希望能够得到详细的指导，确保年检顺利通过。',
                type: 'inquiry',
                status: 'processing',
                submitter: '徐主任',
                submitTime: '2024-01-14',
                contact: '123****3333',
                priority: 'normal',
                department: '教育局',
                wordCount: 58
            }
        ];

        // 登录相关
        document.getElementById('normalLogin').addEventListener('click', function() {
            loginType = 'normal';
            updateLoginUI();
        });

        document.getElementById('governmentLogin').addEventListener('click', function() {
            loginType = 'government';
            updateLoginUI();
        });

        function updateLoginUI() {
            const normalBtn = document.getElementById('normalLogin');
            const governmentBtn = document.getElementById('governmentLogin');
            const nameLabel = document.getElementById('nameLabel');
            const nameInput = document.getElementById('nameInput');
            const loginNote = document.getElementById('loginNote');
            const departmentSelect = document.getElementById('departmentSelect');

            if (loginType === 'normal') {
                normalBtn.className = 'flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors bg-white text-blue-600 shadow-sm';
                governmentBtn.className = 'flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900';
                nameLabel.textContent = '姓名';
                nameInput.placeholder = '请输入您的姓名';
                loginNote.textContent = '登录即表示同意用户协议和隐私政策';
                departmentSelect.classList.add('hidden');
            } else {
                normalBtn.className = 'flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-gray-900';
                governmentBtn.className = 'flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors bg-white text-blue-600 shadow-sm';
                nameLabel.textContent = '政务人员姓名';
                nameInput.placeholder = '请输入政务人员姓名';
                loginNote.textContent = '政务人员登录需要相关权限验证';
                departmentSelect.classList.remove('hidden');
            }
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('nameInput').value;
            const phone = document.getElementById('phoneInput').value;
            const idCard = document.getElementById('idCardInput').value;

            if (!name || !phone || !idCard) {
                alert('请填写完整信息');
                return;
            }

            // 获取部门信息
            let department = null;
            if (loginType === 'government') {
                department = document.getElementById('departmentInput').value;
                if (!department) {
                    alert('请选择所属部门');
                    return;
                }
            }

            currentUser = {
                id: Date.now().toString(),
                name: name,
                phone: phone,
                idCard: idCard,
                userType: loginType,
                location: {
                    province: '北京市',
                    city: '北京市',
                    district: '朝阳区'
                },
                department: department
            };

            // 切换到主应用
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // 更新用户信息
            updateUserInfo();
            
            // 初始化页面内容
            if (currentUser.userType === 'government') {
                // 政务人员界面
                initGovernmentUI();
                initTodoPage();
                initPolicyInterpretationPage();
                initFeedbackPage();
                initProfilePage();
            } else {
                // 普通用户界面
                initNormalUI();
                initHomePage();
                initTransactionsPage();
                initPoliciesPage();
                initProfilePage();
            }
        });

        function updateUserInfo() {
            // 根据用户类型显示不同的问候语
            if (currentUser.userType === 'government' && currentUser.department) {
                document.getElementById('userGreeting').textContent = `您好，${currentUser.name}（${currentUser.department}）`;
            } else {
                document.getElementById('userGreeting').textContent = `您好，${currentUser.name}`;
            }
            document.getElementById('userLocation').textContent = `${currentUser.location.city} · ${currentUser.location.district}`;
            document.getElementById('userAvatar').textContent = currentUser.name.charAt(0);
            
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileType').textContent = currentUser.userType === 'government' ? '政务人员' : '普通用户';
            document.getElementById('profileLocation').textContent = `${currentUser.location.city} · ${currentUser.location.district}`;
            document.getElementById('profileAvatar').textContent = currentUser.name.charAt(0);
            document.getElementById('profilePhone').textContent = currentUser.phone;
            document.getElementById('profileIdCard').textContent = currentUser.idCard;
            
            // 更新部门信息（仅政务人员显示）
            const profileDepartment = document.getElementById('profileDepartment');
            const profileDepartmentContainer = document.getElementById('profileDepartmentContainer');
            if (profileDepartment && profileDepartmentContainer) {
                if (currentUser.userType === 'government' && currentUser.department) {
                    profileDepartment.textContent = currentUser.department;
                    profileDepartmentContainer.style.display = 'flex';
                } else {
                    profileDepartmentContainer.style.display = 'none';
                }
            }
        }

        // 切换标签页
        function switchTab(tabName) {
            // 隐藏所有标签页内容
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 显示选中的标签页
            const selectedTab = document.getElementById(tabName + 'Tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // 更新导航按钮状态
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                item.classList.add('text-gray-600', 'hover:text-gray-900');
            });
            
            // 激活当前选中的导航按钮
            const activeNavItem = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
            if (activeNavItem) {
                activeNavItem.classList.add('active');
                activeNavItem.classList.remove('text-gray-600', 'hover:text-gray-900');
            }
            
            // 根据标签页初始化相应内容
            switch(tabName) {
                case 'home':
                    initHomePage();
                    break;
                case 'transactions':
                    initTransactionsPage();
                    break;
                case 'policies':
                    initPoliciesPage();
                    break;
                case 'todo':
                    initTodoPage();
                    break;
                case 'policyInterpretation':
                    initPolicyInterpretationPage();
                    break;
                case 'feedback':
                    initFeedbackPage();
                    break;
                case 'profile':
                    initProfilePage();
                    break;
                case 'transactionDetail':
                    // 事务详情页面不需要特殊初始化
                    break;
            }
        }

        // 搜索功能
        function handleSearch() {
            const query = document.getElementById('searchInput').value;
            if (query.trim()) {
                alert(`搜索: ${query}`);
                // 这里可以添加搜索逻辑
            }
        }

        // 初始化首页
        function initHomePage() {
            // 首页已经在 DOMContentLoaded 时初始化了常见事务
        }

        // 初始化事务页面
        function initTransactionsPage() {
            const container = document.getElementById('transactionsList');
            container.innerHTML = transactions.map(transaction => {
                const completedSteps = transaction.steps.filter(step => step.status === 'completed').length;
                const progress = (completedSteps / transaction.steps.length) * 100;
                
                return `
                    <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showTransactionDetail('${transaction.id}')">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-900 mb-1">${transaction.title}</h3>
                                <p class="text-gray-600 text-sm mb-2">${transaction.description}</p>
                            </div>
                            <div class="flex items-center px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(transaction.status)}">
                                <i class="fas ${getStatusIcon(transaction.status)} mr-1"></i>
                                <span>${getStatusText(transaction.status)}</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between text-sm text-gray-500">
                            <div class="flex items-center">
                                <i class="fas fa-map-marker-alt mr-1"></i>
                                <span>${transaction.location}</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-clock mr-1"></i>
                                <span>${transaction.estimatedTime}</span>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="flex justify-between text-xs text-gray-500 mb-1">
                                <span>办理进度</span>
                                <span>${completedSteps}/${transaction.steps.length}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: ${progress}%"></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 初始化政策页面
        function initPoliciesPage() {
            // 初始化筛选按钮
            const filters = ['全部', '数字经济', '绿色发展', '科技创新', '智慧城市'];
            const filterContainer = document.getElementById('policyFilters');
            filterContainer.innerHTML = filters.map((filter, index) => `
                <button onclick="filterPolicies('${filter}')" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors ${index === 0 ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}">
                    ${filter}
                </button>
            `).join('');

            // 初始化政策列表
            updatePoliciesList(policies);
        }

        function updatePoliciesList(policiesToShow) {
            const container = document.getElementById('policiesList');
            container.innerHTML = policiesToShow.map(policy => `
                <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showPolicyDetail('${policy.id}')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h3 class="font-semibold text-gray-900 text-sm flex-1">${policy.title}</h3>
                                ${policy.isNew ? '<span class="ml-2 px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full">新政策</span>' : ''}
                            </div>
                            <p class="text-gray-600 text-sm line-clamp-2">${policy.summary}</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <div class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>${formatDate(policy.publishDate)}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-map-marker-alt mr-1"></i>
                            <span>${policy.location}</span>
                        </div>
                    </div>
                    <div class="flex items-center mt-3">
                        <div class="flex items-center text-xs text-gray-500">
                            <i class="fas fa-user mr-1"></i>
                            <span>${policy.author}</span>
                        </div>
                        <div class="flex items-center ml-4">
                            <i class="fas fa-tag mr-1 text-gray-400"></i>
                            <span class="text-xs text-gray-500">${policy.category}</span>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-1 mt-3">
                        ${policy.tags.slice(0, 3).map(tag => `
                            <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full">${tag}</span>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function filterPolicies(category) {
            const filteredPolicies = category === '全部' ? policies : policies.filter(policy => policy.category === category);
            updatePoliciesList(filteredPolicies);
            
            // 更新筛选按钮状态
            document.querySelectorAll('#policyFilters button').forEach((btn, index) => {
                if (index === 0 && category === '全部' || btn.textContent.trim() === category) {
                    btn.className = 'px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors bg-blue-600 text-white';
                } else {
                    btn.className = 'px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200';
                }
            });
        }

        // 初始化政务人员UI
        function initGovernmentUI() {
            // 显示政务人员导航
            document.getElementById('normalUserNav').style.display = 'none';
            document.getElementById('governmentUserNav').style.display = 'flex';
            
            // 更新个人中心切换选项
            document.getElementById('switchToGovernment').style.display = 'none';
            document.getElementById('switchToNormal').style.display = 'flex';
            
            // 更新用户问候语，显示部门信息
            if (currentUser && currentUser.department) {
                const userGreeting = document.getElementById('userGreeting');
                if (userGreeting) {
                    userGreeting.textContent = `您好，${currentUser.name}（${currentUser.department}）`;
                }
            }
            
            // 切换到待办事项页面
            switchTab('todo');
        }

        // 初始化普通用户UI
        function initNormalUI() {
            // 显示普通用户导航
            document.getElementById('normalUserNav').style.display = 'flex';
            document.getElementById('governmentUserNav').style.display = 'none';
            
            // 更新个人中心切换选项
            document.getElementById('switchToGovernment').style.display = 'flex';
            document.getElementById('switchToNormal').style.display = 'none';
            
            // 切换到首页
            switchTab('home');
        }

        // 初始化待办事项页面
        function initTodoPage() {
            // 根据政务人员部门过滤待办事项
            let filteredTodoItems = todoItems;
            if (currentUser && currentUser.userType === 'government' && currentUser.department) {
                filteredTodoItems = todoItems.filter(item => item.department === currentUser.department);
            }
            
            updateTodoList(filteredTodoItems);
            
            // 添加筛选按钮事件
            document.querySelectorAll('#todoFilters .filter-btn').forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    // 更新按钮状态
                    document.querySelectorAll('#todoFilters .filter-btn').forEach(b => {
                        b.className = 'filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap';
                    });
                    this.className = 'filter-btn active px-4 py-2 bg-blue-600 text-white rounded-lg text-sm whitespace-nowrap';
                    
                    // 筛选数据
                    const filterText = this.textContent.trim();
                    let filteredItems = filteredTodoItems;
                    if (filterText === '紧急') {
                        filteredItems = filteredTodoItems.filter(item => item.priority === 'urgent');
                    } else if (filterText === '待审批') {
                        filteredItems = filteredTodoItems.filter(item => item.status === 'pending');
                    } else if (filterText === '已处理') {
                        filteredItems = filteredTodoItems.filter(item => item.status === 'completed');
                    }
                    updateTodoList(filteredItems);
                });
            });
        }

        // 初始化政策解读页面
        function initPolicyInterpretationPage() {
            // 根据政务人员部门过滤政策解读
            let filteredInterpretations = policyInterpretations;
            if (currentUser && currentUser.userType === 'government' && currentUser.department) {
                // 获取本部门的政策
                const departmentPoliciesList = departmentPolicies[currentUser.department] || [];
                // 将部门政策转换为解读格式
                filteredInterpretations = departmentPoliciesList.map(policy => ({
                    id: policy.id,
                    title: policy.title,
                    summary: policy.description,
                    content: policy.content,
                    publishDate: policy.publishDate,
                    author: `${currentUser.department}政策解读员`,
                    category: policy.category,
                    viewCount: Math.floor(Math.random() * 100) + 10,
                    department: policy.department
                }));
            }
            
            updateInterpretationList(filteredInterpretations);
        }

        // 初始化群众反馈页面
        function initFeedbackPage() {
            // 根据政务人员部门过滤群众反馈
            let filteredFeedback = governmentFeedback;
            if (currentUser && currentUser.userType === 'government' && currentUser.department) {
                // 直接根据反馈数据中的department字段进行精确匹配
                filteredFeedback = governmentFeedback.filter(item => 
                    item.department === currentUser.department
                );
            }
            
            updateFeedbackList(filteredFeedback);
            
            // 更新统计信息
            updateFeedbackStats(filteredFeedback);
            
            // 更新AI总结
            updateAISummary(filteredFeedback);
            
            // 显示部门信息提示
            if (currentUser && currentUser.userType === 'government' && currentUser.department) {
                const feedbackHeader = document.querySelector('#feedbackTab .bg-white h1');
                if (feedbackHeader) {
                    feedbackHeader.textContent = `群众反馈 - ${currentUser.department}`;
                }
            }
            
            // 添加筛选按钮事件
            document.querySelectorAll('#feedbackFilters .filter-btn').forEach((btn, index) => {
                btn.addEventListener('click', function() {
                    // 更新按钮状态
                    document.querySelectorAll('#feedbackFilters .filter-btn').forEach(b => {
                        b.className = 'filter-btn px-4 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm whitespace-nowrap';
                    });
                    this.className = 'filter-btn active px-4 py-2 bg-blue-600 text-white rounded-lg text-sm whitespace-nowrap';
                    
                    // 筛选数据
                    const filterText = this.textContent.trim();
                    let filteredItems = filteredFeedback;
                    if (filterText === '新反馈') {
                        filteredItems = filteredFeedback.filter(item => item.status === 'new');
                    } else if (filterText === '处理中') {
                        filteredItems = filteredFeedback.filter(item => item.status === 'processing');
                    } else if (filterText === '已解决') {
                        filteredItems = filteredFeedback.filter(item => item.status === 'resolved');
                    }
                    updateFeedbackList(filteredItems);
                });
            });
        }

        // 初始化个人中心页面
        function initProfilePage() {
            // 个人中心页面内容已经在 HTML 中静态定义
        }

        // 工具函数
        function getStatusColor(status) {
            switch (status) {
                case 'completed': return 'text-green-600 bg-green-100';
                case 'processing': return 'text-blue-600 bg-blue-100';
                case 'pending': return 'text-yellow-600 bg-yellow-100';
                case 'rejected': return 'text-red-600 bg-red-100';
                default: return 'text-gray-600 bg-gray-100';
            }
        }

        function getStatusIcon(status) {
            switch (status) {
                case 'completed': return 'fa-check-circle';
                case 'processing': return 'fa-clock';
                case 'pending': return 'fa-exclamation-circle';
                case 'rejected': return 'fa-times-circle';
                default: return 'fa-clock';
            }
        }

        function getStatusText(status) {
            switch (status) {
                case 'completed': return '已完成';
                case 'processing': return '办理中';
                case 'pending': return '待处理';
                case 'rejected': return '已拒绝';
                default: return '未知状态';
            }
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('zh-CN');
        }

        // 模态框相关
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        // 更新待办事项列表
        function updateTodoList(items) {
            const container = document.getElementById('todoList');
            container.innerHTML = items.map(item => `
                <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showTodoDetail('${item.id}')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h3 class="font-semibold text-gray-900 text-sm flex-1">${item.title}</h3>
                                <span class="ml-2 px-2 py-1 rounded-full text-xs font-medium ${
                                    item.priority === 'urgent' ? 'bg-red-100 text-red-600' : 'bg-blue-100 text-blue-600'
                                }">${item.priority === 'urgent' ? '紧急' : '普通'}</span>
                            </div>
                            <p class="text-gray-600 text-sm line-clamp-2">${item.description}</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <div class="flex items-center">
                            <i class="fas fa-user mr-1"></i>
                            <span>申请人：${item.applicant}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-building mr-1"></i>
                            <span>${item.department}</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-gray-500 mt-2">
                        <div class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>截止：${formatDate(item.deadline)}</span>
                        </div>
                        <div class="flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                            item.status === 'completed' ? 'text-green-600 bg-green-100' :
                            item.status === 'processing' ? 'text-blue-600 bg-blue-100' :
                            'text-yellow-600 bg-yellow-100'
                        }">
                            <i class="fas ${
                                item.status === 'completed' ? 'fa-check-circle' :
                                item.status === 'processing' ? 'fa-clock' :
                                'fa-exclamation-circle'
                            } mr-1"></i>
                            <span>${
                                item.status === 'completed' ? '已完成' :
                                item.status === 'processing' ? '处理中' :
                                '待处理'
                            }</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 更新政策解读列表
        function updateInterpretationList(items) {
            const container = document.getElementById('interpretationList');
            container.innerHTML = items.map(item => `
                <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showInterpretationDetail('${item.id}')">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-900 text-sm mb-2">${item.title}</h3>
                            <p class="text-gray-600 text-sm line-clamp-2">${item.summary}</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <div class="flex items-center">
                            <i class="fas fa-calendar mr-1"></i>
                            <span>${formatDate(item.publishDate)}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-eye mr-1"></i>
                            <span>${item.viewCount} 次查看</span>
                        </div>
                    </div>
                    <div class="flex items-center mt-3">
                        <div class="flex items-center text-xs text-gray-500">
                            <i class="fas fa-user mr-1"></i>
                            <span>${item.author}</span>
                        </div>
                        <div class="flex items-center ml-4">
                            <i class="fas fa-tag mr-1 text-gray-400"></i>
                            <span class="text-xs text-gray-500">${item.category}</span>
                        </div>
                    </div>
                    <div class="flex items-center mt-2">
                        <span class="px-2 py-1 bg-green-100 text-green-600 text-xs rounded-full">已发布</span>
                    </div>
                </div>
            `).join('');
        }

        // 更新反馈列表
        function updateFeedbackList(items) {
            const container = document.getElementById('feedbackList');
            container.innerHTML = items.map(item => {
                
                
                // 内容深度标签
                const getDepthLabel = (wordCount) => {
                    if (wordCount >= 80) return '详细';
                    if (wordCount >= 50) return '一般';
                    return '简短';
                };
                
                const depthColor = {
                    '详细': 'text-purple-600 bg-purple-100',
                    '一般': 'text-blue-600 bg-blue-100',
                    '简短': 'text-gray-600 bg-gray-100'
                };
                
                return `
                    <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showFeedbackDetail('${item.id}')">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex-1">
                                <div class="flex items-center mb-2">
                                    <h3 class="font-semibold text-gray-900 text-sm flex-1">${item.title}</h3>
                                    <div class="flex space-x-1">
                                        <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                            item.priority === 'urgent' ? 'bg-red-100 text-red-600' : 'bg-blue-100 text-blue-600'
                                        }">${item.priority === 'urgent' ? '紧急' : '普通'}</span>
                                        <span class="px-2 py-1 rounded-full text-xs font-medium ${depthColor[getDepthLabel(item.wordCount)]}">
                                            ${getDepthLabel(item.wordCount)}
                                        </span>
                                    </div>
                                </div>
                                <p class="text-gray-600 text-sm line-clamp-2">${item.content}</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between text-xs text-gray-500">
                            <div class="flex items-center">
                                <i class="fas fa-user mr-1"></i>
                                <span>${item.submitter}</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-calendar mr-1"></i>
                                <span>${formatDate(item.submitTime)}</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between text-xs text-gray-500 mt-2">
                            <div class="flex items-center">
                                <i class="fas fa-building mr-1"></i>
                                <span>${item.department}</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-gray-500">
                                    <i class="fas fa-file-alt mr-1"></i>
                                    ${item.wordCount}字
                                </span>
                                <div class="flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                    item.status === 'resolved' ? 'text-green-600 bg-green-100' :
                                    item.status === 'processing' ? 'text-blue-600 bg-blue-100' :
                                    'text-red-600 bg-red-100'
                                }">
                                    <i class="fas ${
                                        item.status === 'resolved' ? 'fa-check-circle' :
                                        item.status === 'processing' ? 'fa-clock' :
                                        'fa-exclamation-circle'
                                    } mr-1"></i>
                                    <span>${
                                        item.status === 'resolved' ? '已解决' :
                                        item.status === 'processing' ? '处理中' :
                                        '新反馈'
                                    }</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 切换到政务人员模式
        function switchToGovernmentMode() {
            const content = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-building text-blue-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">切换到政务人员模式</h3>
                    <p class="text-gray-600 mb-6">需要重新登录以验证政务人员身份</p>
                    <div class="flex space-x-3">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            取消
                        </button>
                        <button onclick="confirmSwitchToGovernment()" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            确认切换
                        </button>
                    </div>
                </div>
            `;
            showModal('切换身份', content);
        }

        // 切换到普通用户模式
        function switchToNormalMode() {
            const content = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">切换到普通用户模式</h3>
                    <p class="text-gray-600 mb-6">需要重新登录以验证普通用户身份</p>
                    <div class="flex space-x-3">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            取消
                        </button>
                        <button onclick="confirmSwitchToNormal()" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            确认切换
                        </button>
                    </div>
                </div>
            `;
            showModal('切换身份', content);
        }

        // 确认切换到政务人员模式
        function confirmSwitchToGovernment() {
            closeModal();
            logoutAndSwitchMode('government');
        }

        // 确认切换到普通用户模式
        function confirmSwitchToNormal() {
            closeModal();
            logoutAndSwitchMode('normal');
        }

        // 退出登录并切换模式
        function logoutAndSwitchMode(targetMode) {
            // 隐藏主应用
            document.getElementById('mainApp').style.display = 'none';
            
            // 显示登录页面
            const loginPage = document.getElementById('loginPage');
            loginPage.style.display = 'flex';
            
            // 重置用户状态
            currentUser = null;
            
            // 重置登录表单
            document.getElementById('loginForm').reset();
            
            // 设置目标登录类型
            loginType = targetMode;
            updateLoginUI();
            
            // 确保页面滚动到顶部
            window.scrollTo(0, 0);
            
            // 强制重新计算布局并确保居中
            setTimeout(() => {
                loginPage.style.display = 'flex';
                loginPage.style.alignItems = 'center';
                loginPage.style.justifyContent = 'center';
            }, 10);
        }

        function showTransactionDetail(transactionId) {
            const transaction = transactions.find(t => t.id === transactionId);
            if (!transaction) return;

            const content = `
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">基本信息</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">状态：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(transaction.status)}">
                                    ${getStatusText(transaction.status)}
                                </span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">办理地点：</span>
                                <span>${transaction.location}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">预计时间：</span>
                                <span>${transaction.estimatedTime}</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">办理步骤</h3>
                        <div class="space-y-3">
                            ${transaction.steps.map((step, index) => `
                                <div class="flex items-start">
                                    <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium mr-3 ${
                                        step.status === 'completed' ? 'bg-green-100 text-green-600' :
                                        step.status === 'current' ? 'bg-blue-100 text-blue-600' :
                                        'bg-gray-100 text-gray-400'
                                    }">
                                        ${step.status === 'completed' ? '✓' : index + 1}
                                    </div>
                                    <div class="flex-1">
                                        <h4 class="font-medium text-gray-900 text-sm">${step.title}</h4>
                                        <p class="text-gray-600 text-xs mt-1">${step.description}</p>
                                        <div class="flex items-center mt-2 text-xs text-gray-500">
                                            <i class="fas fa-map-marker-alt mr-1"></i>
                                            <span class="mr-4">${step.location}</span>
                                            <i class="fas fa-clock mr-1"></i>
                                            <span>${step.estimatedTime}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">所需材料</h3>
                        <div class="space-y-1">
                            ${transaction.requiredDocuments.map(doc => `
                                <div class="flex items-center text-sm">
                                    <i class="fas fa-file-alt text-gray-400 mr-2"></i>
                                    <span>${doc}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            showModal(transaction.title, content);
        }

        function showPolicyDetail(policyId) {
            const policy = policies.find(p => p.id === policyId);
            if (!policy) return;

            const content = `
                <div class="space-y-4">
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">发布机构：</span>
                            <span>${policy.author}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">发布时间：</span>
                            <span>${formatDate(policy.publishDate)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">生效时间：</span>
                            <span>${formatDate(policy.effectiveDate)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">适用范围：</span>
                            <span>${policy.location}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">政策分类：</span>
                            <span>${policy.category}</span>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">政策标签</h3>
                        <div class="flex flex-wrap gap-2">
                            ${policy.tags.map(tag => `
                                <span class="px-3 py-1 bg-blue-100 text-blue-600 text-sm rounded-full">${tag}</span>
                            `).join('')}
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">政策内容</h3>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="text-sm text-gray-700 whitespace-pre-line">${policy.content}</div>
                        </div>
                    </div>
                </div>
            `;

            showModal(policy.title, content);
        }

        // 退出登录确认弹窗
        function showLogoutConfirm() {
            const content = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-sign-out-alt text-red-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">确认退出</h3>
                    <p class="text-gray-600 mb-6">确定要退出登录吗？退出后需要重新登录。</p>
                    <div class="flex space-x-3">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            取消
                        </button>
                        <button onclick="confirmLogout()" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
                            确认退出
                        </button>
                    </div>
                </div>
            `;
            showModal('退出登录', content);
        }

        // 确认退出登录
        function confirmLogout() {
            // 关闭模态框
            closeModal();
            
            // 隐藏主应用
            document.getElementById('mainApp').style.display = 'none';
            
            // 显示登录页面并确保居中
            const loginPage = document.getElementById('loginPage');
            loginPage.style.display = 'flex';
            
            // 重置用户状态
            currentUser = null;
            
            // 重置登录表单
            document.getElementById('loginForm').reset();
            
            // 重置登录类型为普通用户
            loginType = 'normal';
            updateLoginUI();
            
            // 确保页面滚动到顶部
            window.scrollTo(0, 0);
            
            // 强制重新计算布局并确保居中
            setTimeout(() => {
                loginPage.style.display = 'flex';
                loginPage.style.alignItems = 'center';
                loginPage.style.justifyContent = 'center';
            }, 10);
        }

        // 显示反馈模态框
        function showFeedbackModal() {
            const content = `
                <div class="space-y-4">
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-comment-dots text-blue-500 text-2xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">意见反馈</h3>
                        <p class="text-gray-600 text-sm">您的反馈对我们很重要，感谢您的宝贵意见</p>
                    </div>
                    
                    <form id="feedbackForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">反馈类型</label>
                            <select id="feedbackType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="suggestion">功能建议</option>
                                <option value="bug">问题报告</option>
                                <option value="complaint">投诉建议</option>
                                <option value="praise">表扬感谢</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">反馈标题</label>
                            <input type="text" id="feedbackTitle" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请简要描述您的反馈" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">详细描述</label>
                            <textarea id="feedbackContent" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请详细描述您的问题或建议..." required></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">联系方式（可选）</label>
                            <input type="text" id="feedbackContact" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="手机号或邮箱，方便我们回复您">
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="button" onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                                取消
                            </button>
                            <button type="submit" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                提交反馈
                            </button>
                        </div>
                    </form>
                </div>
            `;
            showModal('意见反馈', content);
            
            // 添加表单提交事件
            document.getElementById('feedbackForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitFeedback();
            });
        }
        
        // 提交反馈
        function submitFeedback() {
            const type = document.getElementById('feedbackType').value;
            const title = document.getElementById('feedbackTitle').value;
            const content = document.getElementById('feedbackContent').value;
            const contact = document.getElementById('feedbackContact').value;
            
            if (!title.trim() || !content.trim()) {
                alert('请填写反馈标题和详细描述');
                return;
            }
            
            // 模拟提交反馈
            const feedback = {
                type: type,
                title: title,
                content: content,
                contact: contact,
                user: currentUser ? currentUser.name : '匿名用户',
                timestamp: new Date().toISOString()
            };
            
            console.log('提交反馈:', feedback);
            
            // 显示提交成功提示
            const successContent = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-check text-green-500 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">反馈提交成功</h3>
                    <p class="text-gray-600 mb-6">感谢您的反馈，我们会认真处理您的建议</p>
                    <button onclick="closeModal()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        确定
                    </button>
                </div>
            `;
            
            showModal('提交成功', successContent);
        }

        // 政务人员详情查看函数
        function showTodoDetail(todoId) {
            const todo = todoItems.find(t => t.id === todoId);
            if (!todo) return;

            const content = `
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">基本信息</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">状态：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                    todo.status === 'completed' ? 'text-green-600 bg-green-100' :
                                    todo.status === 'processing' ? 'text-blue-600 bg-blue-100' :
                                    'text-yellow-600 bg-yellow-100'
                                }">
                                    ${todo.status === 'completed' ? '已完成' :
                                      todo.status === 'processing' ? '处理中' : '待处理'}
                                </span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">优先级：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                    todo.priority === 'urgent' ? 'text-red-600 bg-red-100' : 'text-blue-600 bg-blue-100'
                                }">
                                    ${todo.priority === 'urgent' ? '紧急' : '普通'}
                                </span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">申请人：</span>
                                <span>${todo.applicant}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">所属部门：</span>
                                <span>${todo.department}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">办理地点：</span>
                                <span>${todo.location}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">截止时间：</span>
                                <span>${formatDate(todo.deadline)}</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">事项描述</h3>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="text-sm text-gray-700">${todo.description}</div>
                        </div>
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            关闭
                        </button>
                        <button onclick="processTodo('${todo.id}')" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            处理事项
                        </button>
                    </div>
                </div>
            `;
            showModal(todo.title, content);
        }

        function showInterpretationDetail(interpretationId) {
            const interpretation = policyInterpretations.find(i => i.id === interpretationId);
            if (!interpretation) return;

            const content = `
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">基本信息</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">发布状态：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium text-green-600 bg-green-100">已发布</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">发布时间：</span>
                                <span>${formatDate(interpretation.publishDate)}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">查看次数：</span>
                                <span>${interpretation.viewCount} 次</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">作者：</span>
                                <span>${interpretation.author}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">分类：</span>
                                <span>${interpretation.category}</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">解读内容</h3>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="text-sm text-gray-700 whitespace-pre-line">${interpretation.content}</div>
                        </div>
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            关闭
                        </button>
                        <button onclick="editInterpretation('${interpretation.id}')" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            编辑解读
                        </button>
                    </div>
                </div>
            `;
            showModal(interpretation.title, content);
        }

        function showFeedbackDetail(feedbackId) {
            const feedback = governmentFeedback.find(f => f.id === feedbackId);
            if (!feedback) return;

            const content = `
                <div class="space-y-4">
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">反馈信息</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">状态：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                    feedback.status === 'resolved' ? 'text-green-600 bg-green-100' :
                                    feedback.status === 'processing' ? 'text-blue-600 bg-blue-100' :
                                    'text-red-600 bg-red-100'
                                }">
                                    ${feedback.status === 'resolved' ? '已解决' :
                                      feedback.status === 'processing' ? '处理中' : '新反馈'}
                                </span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">优先级：</span>
                                <span class="px-2 py-1 rounded-full text-xs font-medium ${
                                    feedback.priority === 'urgent' ? 'text-red-600 bg-red-100' : 'text-blue-600 bg-blue-100'
                                }">
                                    ${feedback.priority === 'urgent' ? '紧急' : '普通'}
                                </span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">提交人：</span>
                                <span>${feedback.submitter}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">提交时间：</span>
                                <span>${formatDate(feedback.submitTime)}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">联系方式：</span>
                                <span>${feedback.contact}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">负责部门：</span>
                                <span>${feedback.department}</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-900 mb-2">反馈内容</h3>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <div class="text-sm text-gray-700">${feedback.content}</div>
                        </div>
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            关闭
                        </button>
                        <button onclick="processFeedback('${feedback.id}')" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            处理反馈
                        </button>
                    </div>
                </div>
            `;
            showModal(feedback.title, content);
        }

        // 处理待办事项
        function processTodo(todoId) {
            alert('开始处理待办事项...');
            closeModal();
        }

        // 编辑政策解读
        function editInterpretation(interpretationId) {
            alert('进入编辑模式...');
            closeModal();
        }

        // 处理群众反馈
        function processFeedback(feedbackId) {
            alert('开始处理群众反馈...');
            closeModal();
        }

        // 点击模态框外部关闭
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // 返回首页
        function backToHome() {
            switchTab('home');
        }

        // 事务详情页面相关函数
        function showTransactionDetailPage(transactionId) {
            console.log('showTransactionDetailPage called with ID:', transactionId);
            
            // 根据常见事务ID映射到实际事务数据
            const transactionMap = {
                '1': {
                    id: '1',
                    title: '身份证办理',
                    description: '居民身份证申领、换领、补领服务',
                    type: '身份证',
                    estimatedTime: '7个工作日',
                    requiredDocuments: ['户口本', '照片'],
                    steps: [
                        {
                            id: '1-1',
                            title: '前往户政服务中心',
                            description: '携带相关证件到窗口提交申请',
                            status: 'completed',
                            location: '户政服务中心',
                            estimatedTime: '30分钟'
                        },
                        {
                            id: '1-2',
                            title: '填写申请表',
                            description: '填写《居民身份证申领登记表》',
                            status: 'current',
                            location: '户政服务中心',
                            estimatedTime: '15分钟'
                        },
                        {
                            id: '1-3',
                            title: '现场拍照',
                            description: '现场拍照或提交电子照片',
                            status: 'pending',
                            location: '户政服务中心',
                            estimatedTime: '10分钟'
                        },
                        {
                            id: '1-4',
                            title: '缴纳工本费',
                            description: '缴纳身份证工本费',
                            status: 'pending',
                            location: '户政服务中心',
                            estimatedTime: '5分钟'
                        },
                        {
                            id: '1-5',
                            title: '等待制作',
                            description: '等待身份证制作完成',
                            status: 'pending',
                            location: '制证中心',
                            estimatedTime: '7个工作日'
                        },
                        {
                            id: '1-6',
                            title: '领取身份证',
                            description: '凭领取凭证领取身份证',
                            status: 'pending',
                            location: '户政服务中心',
                            estimatedTime: '10分钟'
                        }
                    ]
                },
                '2': {
                    id: '2',
                    title: '驾驶证办理',
                    description: '机动车驾驶证申领服务',
                    type: '驾驶证',
                    estimatedTime: '15-30个工作日',
                    requiredDocuments: ['身份证', '体检报告', '照片'],
                    steps: [
                        {
                            id: '2-1',
                            title: '预约体检',
                            description: '预约并参加体检',
                            status: 'completed',
                            location: '指定医院',
                            estimatedTime: '1小时'
                        },
                        {
                            id: '2-2',
                            title: '科目一考试',
                            description: '参加科目一理论考试',
                            status: 'current',
                            location: '车管所',
                            estimatedTime: '45分钟'
                        },
                        {
                            id: '2-3',
                            title: '科目二考试',
                            description: '参加科目二场地考试',
                            status: 'pending',
                            location: '考试场地',
                            estimatedTime: '30分钟'
                        },
                        {
                            id: '2-4',
                            title: '科目三考试',
                            description: '参加科目三道路考试',
                            status: 'pending',
                            location: '考试路线',
                            estimatedTime: '20分钟'
                        },
                        {
                            id: '2-5',
                            title: '科目四考试',
                            description: '参加科目四安全文明考试',
                            status: 'pending',
                            location: '车管所',
                            estimatedTime: '45分钟'
                        },
                        {
                            id: '2-6',
                            title: '领取驾驶证',
                            description: '考试通过后领取驾驶证',
                            status: 'pending',
                            location: '车管所',
                            estimatedTime: '30分钟'
                        }
                    ]
                },
                '3': {
                    id: '3',
                    title: '结婚登记',
                    description: '办理结婚证书服务',
                    type: '结婚登记',
                    estimatedTime: '当场办理，约30分钟',
                    requiredDocuments: ['身份证', '户口本', '照片', '未婚证明'],
                    steps: [
                        {
                            id: '3-1',
                            title: '双方到场',
                            description: '双方携带证件前往民政局',
                            status: 'completed',
                            location: '民政局婚姻登记处',
                            estimatedTime: '10分钟'
                        },
                        {
                            id: '3-2',
                            title: '填写申请书',
                            description: '填写《结婚登记申请书》',
                            status: 'current',
                            location: '民政局婚姻登记处',
                            estimatedTime: '10分钟'
                        },
                        {
                            id: '3-3',
                            title: '提交材料',
                            description: '提交身份证、户口本等材料',
                            status: 'pending',
                            location: '民政局婚姻登记处',
                            estimatedTime: '5分钟'
                        },
                        {
                            id: '3-4',
                            title: '缴纳费用',
                            description: '缴纳结婚登记费',
                            status: 'pending',
                            location: '民政局婚姻登记处',
                            estimatedTime: '2分钟'
                        },
                        {
                            id: '3-5',
                            title: '领取结婚证',
                            description: '当场领取结婚证书',
                            status: 'pending',
                            location: '民政局婚姻登记处',
                            estimatedTime: '3分钟'
                        }
                    ]
                },
                '4': {
                    id: '4',
                    title: '社保卡办理',
                    description: '社会保障卡申领服务',
                    type: '社保卡',
                    estimatedTime: '15-20个工作日',
                    requiredDocuments: ['身份证', '照片'],
                    steps: [
                        {
                            id: '4-1',
                            title: '前往社保中心',
                            description: '携带身份证到社保服务中心',
                            status: 'completed',
                            location: '社保服务中心',
                            estimatedTime: '30分钟'
                        },
                        {
                            id: '4-2',
                            title: '填写申请表',
                            description: '填写《社会保障卡申领表》',
                            status: 'current',
                            location: '社保服务中心',
                            estimatedTime: '15分钟'
                        },
                        {
                            id: '4-3',
                            title: '提交材料',
                            description: '提交身份证和照片',
                            status: 'pending',
                            location: '社保服务中心',
                            estimatedTime: '10分钟'
                        },
                        {
                            id: '4-4',
                            title: '等待制卡',
                            description: '等待社保卡制作完成',
                            status: 'pending',
                            location: '制卡中心',
                            estimatedTime: '15-20个工作日'
                        },
                        {
                            id: '4-5',
                            title: '领取社保卡',
                            description: '凭领取凭证领取社保卡',
                            status: 'pending',
                            location: '社保服务中心',
                            estimatedTime: '10分钟'
                        }
                    ]
                },
                '5': {
                    id: '5',
                    title: '营业执照办理',
                    description: '工商营业执照申领服务',
                    type: '营业执照',
                    estimatedTime: '3-5个工作日',
                    requiredDocuments: ['身份证', '场地证明', '公司章程'],
                    steps: [
                        {
                            id: '5-1',
                            title: '企业名称核准',
                            description: '提交企业名称预先核准申请',
                            status: 'completed',
                            location: '市场监督管理局',
                            estimatedTime: '1个工作日'
                        },
                        {
                            id: '5-2',
                            title: '提交申请材料',
                            description: '提交营业执照申请材料',
                            status: 'current',
                            location: '市场监督管理局',
                            estimatedTime: '1小时'
                        },
                        {
                            id: '5-3',
                            title: '材料审核',
                            description: '审核申请材料',
                            status: 'pending',
                            location: '市场监督管理局',
                            estimatedTime: '2个工作日'
                        },
                        {
                            id: '5-4',
                            title: '现场核查',
                            description: '对经营场所进行现场核查',
                            status: 'pending',
                            location: '经营场所',
                            estimatedTime: '1个工作日'
                        },
                        {
                            id: '5-5',
                            title: '审批通过',
                            description: '审批通过，发放营业执照',
                            status: 'pending',
                            location: '市场监督管理局',
                            estimatedTime: '1个工作日'
                        }
                    ]
                },
                '6': {
                    id: '6',
                    title: '出生证明',
                    description: '新生儿出生医学证明',
                    type: '出生证明',
                    estimatedTime: '1个工作日',
                    requiredDocuments: ['父母身份证', '结婚证', '医院证明'],
                    steps: [
                        {
                            id: '6-1',
                            title: '医院开具证明',
                            description: '在出生医院开具出生医学证明',
                            status: 'completed',
                            location: '出生医院',
                            estimatedTime: '30分钟'
                        },
                        {
                            id: '6-2',
                            title: '提交材料',
                            description: '提交相关材料到户籍部门',
                            status: 'current',
                            location: '户籍部门',
                            estimatedTime: '30分钟'
                        },
                        {
                            id: '6-3',
                            title: '审核办理',
                            description: '审核材料并办理出生证明',
                            status: 'pending',
                            location: '户籍部门',
                            estimatedTime: '1个工作日'
                        }
                    ]
                }
            };

            const transaction = transactionMap[transactionId];
            if (!transaction) {
                console.log('Transaction not found for ID:', transactionId);
                alert('未找到该事务');
                return;
            }

            console.log('Found transaction:', transaction);

            // 获取用户地址信息
            const userLocation = currentUser?.location || { province: '北京市', city: '北京市', district: '朝阳区' };

            // 根据事务类型和用户地址获取对应的在线办理网址
            const getOnlineUrls = (transactionType, userLocation) => {
                // 根据用户地址确定对应的政务服务平台
                let baseUrl, mobileUrl, appName;
                
                if (userLocation.province === '北京市' || userLocation.city === '北京市') {
                    baseUrl = 'https://www.beijing.gov.cn';
                    mobileUrl = 'https://m.beijing.gov.cn';
                    appName = '北京通';
                } else if (userLocation.province === '广东省' || userLocation.city === '广州市') {
                    baseUrl = 'https://www.gdzwfw.gov.cn';
                    mobileUrl = 'https://m.gdzwfw.gov.cn';
                    appName = '粤省事';
                } else if (userLocation.province === '上海市' || userLocation.city === '上海市') {
                    baseUrl = 'https://www.shanghai.gov.cn';
                    mobileUrl = 'https://m.shanghai.gov.cn';
                    appName = '随申办';
                } else if (userLocation.province === '深圳市' || userLocation.city === '深圳市') {
                    baseUrl = 'https://www.sz.gov.cn';
                    mobileUrl = 'https://m.sz.gov.cn';
                    appName = 'i深圳';
                } else {
                    // 默认使用全国政务服务平台
                    baseUrl = 'https://www.gjzwfw.gov.cn';
                    mobileUrl = 'https://m.gjzwfw.gov.cn';
                    appName = '国家智"惠"民生平台';
                }
                
                const urlMap = {
                    '身份证': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000001`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000001`,
                        app: `${appName}-身份证办理`,
                        address: `${userLocation.city}市公安局户政服务中心`
                    },
                    '驾驶证': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000002`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000002`,
                        app: `${appName}-驾驶证办理`,
                        address: `${userLocation.city}市车管所`
                    },
                    '结婚登记': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000003`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000003`,
                        app: `${appName}-结婚登记`,
                        address: `${userLocation.district}区民政局婚姻登记处`
                    },
                    '社保卡': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000004`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000004`,
                        app: `${appName}-社保卡办理`,
                        address: `${userLocation.district}区社保服务中心`
                    },
                    '营业执照': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000005`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000005`,
                        app: `${appName}-营业执照办理`,
                        address: `${userLocation.district}区市场监督管理局`
                    },
                    '出生证明': {
                        official: `${baseUrl}/portal/guide/11440000MB2C9000004440000006`,
                        mobile: `${mobileUrl}/portal/guide/11440000MB2C9000004440000006`,
                        app: `${appName}-出生证明`,
                        address: `${userLocation.district}区户籍部门`
                    }
                };
                return urlMap[transactionType] || {
                    official: baseUrl,
                    mobile: mobileUrl,
                    app: appName,
                    address: `${userLocation.city}市政务服务中心`
                };
            };

            const onlineUrls = getOnlineUrls(transaction.type, userLocation);

            console.log('Switching to transaction detail tab...');
            // 切换到事务详情页面
            switchTab('transactionDetail');
            
            console.log('Rendering transaction detail content...');
            // 渲染事务详情内容
            const content = `
                <div class="space-y-6">
                    <!-- 事务头部信息 -->
                    <div class="flex items-start">
                        <div class="w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center text-3xl mr-4">
                            <i class="fas fa-file-alt text-blue-600"></i>
                        </div>
                        <div class="flex-1">
                            <h1 class="text-2xl font-bold text-gray-900 mb-2">${transaction.title}</h1>
                            <p class="text-gray-600 mb-3">${transaction.description}</p>
                                                            <div class="flex flex-wrap items-center text-sm text-gray-500">
                                    <div class="flex items-center mr-4 mb-2">
                                        <i class="fas fa-clock mr-1"></i>
                                        <span>${transaction.estimatedTime}</span>
                                    </div>
                                    <div class="flex items-center mr-4 mb-2">
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        <span>${onlineUrls.address}</span>
                                        <button onclick="showLocationSelector()" class="ml-1 text-blue-600 hover:text-blue-800">
                                            <i class="fas fa-edit text-xs"></i>
                                        </button>
                                    </div>
                                    <div class="flex items-center mb-2">
                                        <i class="fas fa-file-alt mr-1"></i>
                                        <span>${transaction.requiredDocuments.length}项材料</span>
                                    </div>
                                </div>
                        </div>
                    </div>

                    <!-- 办理流程 -->
                    <div class="bg-white rounded-lg shadow-sm p-5">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-list-check text-blue-600 mr-2"></i>
                            <h2 class="text-lg font-semibold text-gray-900">办理流程</h2>
                        </div>
                        <div class="space-y-4">
                            ${transaction.steps.map((step, index) => `
                                <div class="relative pl-8 pb-5 last:pb-0">
                                    <div class="absolute left-0 top-0 bottom-0 flex flex-col items-center">
                                        <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${
                                            step.status === 'completed' ? 'bg-green-100 text-green-600' :
                                            step.status === 'current' ? 'bg-blue-100 text-blue-600' :
                                            'bg-gray-100 text-gray-400'
                                        }">
                                            ${step.status === 'completed' ? '✓' : index + 1}
                                        </div>
                                        ${index < transaction.steps.length - 1 ? '<div class="w-0.5 bg-gray-200 flex-grow mt-1"></div>' : ''}
                                    </div>
                                    <div class="text-gray-700">
                                        <h4 class="font-medium text-gray-900">${step.title}</h4>
                                        <p class="text-gray-600 text-sm mt-1">${step.description}</p>
                                        <div class="flex items-center mt-2 text-xs text-gray-500">
                                            <i class="fas fa-map-marker-alt mr-1"></i>
                                            <span class="mr-4">${step.location}</span>
                                            <i class="fas fa-clock mr-1"></i>
                                            <span>${step.estimatedTime}</span>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 所需材料 -->
                    <div class="bg-white rounded-lg shadow-sm p-5">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-file-alt text-blue-600 mr-2"></i>
                            <h2 class="text-lg font-semibold text-gray-900">所需材料</h2>
                        </div>
                        <ul class="space-y-3">
                            ${transaction.requiredDocuments.map((doc, index) => `
                                <li class="flex items-start">
                                    <div class="w-5 h-5 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-medium mr-3 mt-0.5">
                                        ${index + 1}
                                    </div>
                                    <span class="text-gray-700">${doc}</span>
                                </li>
                            `).join('')}
                        </ul>
                    </div>

                    <!-- 办理地址 -->
                    <div class="bg-white rounded-lg shadow-sm p-5">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center">
                                <i class="fas fa-map-marker-alt text-blue-600 mr-2"></i>
                                <h2 class="text-lg font-semibold text-gray-900">办理地址</h2>
                            </div>
                            <button onclick="showLocationSelector()" class="text-blue-600 text-sm hover:text-blue-800">
                                <i class="fas fa-edit"></i> 更换地址
                            </button>
                        </div>
                        <div class="space-y-3">
                            <div class="text-gray-700">
                                <strong>主要办理点：</strong>${onlineUrls.address}
                            </div>
                            <div class="text-sm text-gray-600">
                                <strong>其他办理点：</strong>
                                <ul class="mt-2 space-y-1">
                                    <li>• ${userLocation.city}市政务服务中心</li>
                                    <li>• ${userLocation.district}区政务服务中心</li>
                                    <li>• 就近派出所户籍窗口</li>
                                    <li>• ${userLocation.district}区便民服务中心</li>
                                </ul>
                            </div>
                            <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                                <div class="flex items-center text-sm text-blue-700 mb-2">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <span>温馨提示</span>
                                </div>
                                <div class="text-xs text-blue-600">
                                    • 建议提前电话咨询办理时间<br>
                                    • 可在线预约办理时间<br>
                                    • 支持邮寄办理，足不出户
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 网上需要填写的信息 -->
                    <div class="bg-white rounded-lg shadow-sm p-5">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-clipboard text-blue-600 mr-2"></i>
                            <h2 class="text-lg font-semibold text-gray-900">网上需要填写的信息</h2>
                        </div>
                        <ul class="space-y-3 mb-4">
                            ${['姓名', '性别', '身份证号', '联系电话', '家庭住址', '工作单位'].map((field, index) => `
                                <li class="flex items-start">
                                    <div class="w-5 h-5 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-medium mr-3 mt-0.5">
                                        ${index + 1}
                                    </div>
                                    <span class="text-gray-700">${field}</span>
                                </li>
                            `).join('')}
                        </ul>
                        
                        <!-- 在线办理链接 -->
                        <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-globe text-blue-600 mr-2"></i>
                                <h3 class="font-medium text-gray-900">在线办理网址</h3>
                            </div>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">官方网站：</span>
                                    <a href="${onlineUrls.official}" target="_blank" class="text-blue-600 text-sm hover:underline">
                                        ${onlineUrls.official}
                                    </a>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">移动端：</span>
                                    <a href="${onlineUrls.mobile}" target="_blank" class="text-blue-600 text-sm hover:underline">
                                        ${onlineUrls.mobile}
                                    </a>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-gray-600">微信小程序：</span>
                                    <span class="text-sm text-gray-500">搜索"${onlineUrls.app}"</span>
                                </div>
                            </div>
                            <div class="mt-3 p-3 bg-white rounded border border-gray-200">
                                <div class="flex items-center text-sm text-gray-600 mb-2">
                                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                    <span>办理提示</span>
                                </div>
                                <ul class="text-xs text-gray-600 space-y-1">
                                    <li>• 首次使用需要注册账号并实名认证</li>
                                    <li>• 请准备好相关证件照片，支持拍照上传</li>
                                    <li>• 办理过程中可随时保存，支持断点续办</li>
                                    <li>• 提交后可在"我的事务"中查看进度</li>
                                    <li>• 支持${userLocation.province}${userLocation.city}市本地化服务</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 底部操作按钮 -->
                    <div class="fixed bottom-0 left-0 right-0 bg-white shadow-lg p-4 flex">
                        <button class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-lg mr-3 font-medium">
                            收藏
                        </button>
                        <button onclick="window.open('${onlineUrls.official}', '_blank')" class="flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium">
                            在线办理
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('transactionDetailContent').innerHTML = content;
            console.log('Transaction detail content rendered successfully');
        }

        // 搜索功能
        function handleSearch() {
            const searchQuery = document.getElementById('searchInput').value.trim();
            if (!searchQuery) {
                alert('请输入搜索内容');
                return;
            }

            // 搜索事务
            const searchResults = transactions.filter(transaction => 
                transaction.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                transaction.description.toLowerCase().includes(searchQuery.toLowerCase())
            );

            if (searchResults.length === 1) {
                // 只有一个结果，直接跳转到详情页
                showTransactionDetailPage(searchResults[0].id);
            } else if (searchResults.length > 1) {
                // 多个结果，显示选择列表
                showSearchResults(searchResults);
            } else {
                alert('未找到相关事务');
            }
        }

        // 显示搜索结果列表
        function showSearchResults(results) {
            const content = `
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">搜索结果</h3>
                    ${results.map(transaction => `
                        <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showTransactionDetailPage('${transaction.id}')">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-xl mr-4">
                                    <i class="fas fa-file-alt text-blue-600"></i>
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">${transaction.title}</h4>
                                    <p class="text-gray-500 text-sm">${transaction.description}</p>
                                    <div class="flex items-center text-xs text-gray-400 mt-1">
                                        <i class="fas fa-clock mr-1"></i>
                                        <span class="mr-3">${transaction.estimatedTime}</span>
                                        <i class="fas fa-file-alt mr-1"></i>
                                        <span>${transaction.requiredDocuments.length}项材料</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            showModal('搜索结果', content);
        }

        // 初始化常见事务
        function initCommonTransactions() {
            const container = document.getElementById('commonTransactions');
            const commonTransactions = [
                {
                    id: '1',
                    title: '身份证办理',
                    description: '居民身份证申领、换领、补领服务',
                    icon: '🪪',
                    estimatedTime: '7个工作日',
                    materials: 2,
                    type: '身份证'
                },
                {
                    id: '2',
                    title: '驾驶证办理',
                    description: '机动车驾驶证申领服务',
                    icon: '🚗',
                    estimatedTime: '15-30个工作日',
                    materials: 3,
                    type: '驾驶证'
                },
                {
                    id: '3',
                    title: '结婚登记',
                    description: '办理结婚证书服务',
                    icon: '💍',
                    estimatedTime: '当场办理，约30分钟',
                    materials: 4,
                    type: '结婚登记'
                },
                {
                    id: '4',
                    title: '社保卡办理',
                    description: '社会保障卡申领服务',
                    icon: '💳',
                    estimatedTime: '15-20个工作日',
                    materials: 2,
                    type: '社保卡'
                },
                {
                    id: '5',
                    title: '营业执照办理',
                    description: '工商营业执照申领服务',
                    icon: '🏢',
                    estimatedTime: '3-5个工作日',
                    materials: 5,
                    type: '营业执照'
                },
                {
                    id: '6',
                    title: '出生证明',
                    description: '新生儿出生医学证明',
                    icon: '👶',
                    estimatedTime: '1个工作日',
                    materials: 3,
                    type: '出生证明'
                }
            ];

            container.innerHTML = commonTransactions.map(transaction => `
                <div class="bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-100" onclick="showTransactionDetailPage('${transaction.id}')">
                    <div class="flex items-center mb-3">
                        <span class="text-2xl mr-3">${transaction.icon}</span>
                        <div class="text-left">
                            <h3 class="font-medium text-gray-900 text-sm">${transaction.title}</h3>
                            <p class="text-gray-500 text-xs">${transaction.description}</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <div class="flex items-center">
                            <i class="fas fa-clock mr-1"></i>
                            <span>${transaction.estimatedTime}</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-file-alt mr-1"></i>
                            <span>${transaction.materials}项材料</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 页面初始化时调用
        document.addEventListener('DOMContentLoaded', function() {
            initCommonTransactions();
        });

        // 地址选择器相关函数
        function showLocationSelector() {
            const content = `
                <div class="space-y-4">
                    <div class="text-sm text-gray-600 mb-4">
                        选择您的地址，系统将为您提供相应的政务服务
                    </div>
                    
                    <!-- 常用地址 -->
                    <div class="space-y-3">
                        <h3 class="font-medium text-gray-900">常用地址</h3>
                        <div class="space-y-2">
                            <button onclick="selectLocation('北京市', '北京市', '朝阳区')" class="w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-900">北京市朝阳区</div>
                                        <div class="text-sm text-gray-500">北京智"惠"民生平台</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </button>
                            
                            <button onclick="selectLocation('广东省', '广州市', '天河区')" class="w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-900">广州市天河区</div>
                                        <div class="text-sm text-gray-500">广东智"惠"民生平台</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </button>
                            
                            <button onclick="selectLocation('上海市', '上海市', '浦东新区')" class="w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-900">上海市浦东新区</div>
                                        <div class="text-sm text-gray-500">上海智"惠"民生平台</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </button>
                            
                            <button onclick="selectLocation('深圳市', '深圳市', '南山区')" class="w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-900">深圳市南山区</div>
                                        <div class="text-sm text-gray-500">深圳智"惠"民生平台</div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </button>
                        </div>
                    </div>
                    
                    <!-- 手动输入地址 -->
                    <div class="space-y-3">
                        <h3 class="font-medium text-gray-900">手动输入</h3>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">省份</label>
                                <input type="text" id="provinceInput" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入省份">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">城市</label>
                                <input type="text" id="cityInput" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入城市">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">区县</label>
                                <input type="text" id="districtInput" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="请输入区县">
                            </div>
                            <button onclick="selectCustomLocation()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors">
                                确认选择
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('locationModalContent').innerHTML = content;
            document.getElementById('locationModal').classList.add('show');
        }

        function closeLocationModal() {
            document.getElementById('locationModal').classList.remove('show');
        }

        function selectLocation(province, city, district) {
            if (currentUser) {
                currentUser.location = { province, city, district };
                updateUserInfo();
                
                // 如果当前在事务详情页，重新渲染详情页内容
                if (currentTab === 'transactionDetail') {
                    const currentTransactionId = getCurrentTransactionId();
                    if (currentTransactionId) {
                        showTransactionDetailPage(currentTransactionId);
                    }
                }
            }
            
            closeLocationModal();
            
            // 显示成功提示
            showToast('地址已更新');
        }

        function selectCustomLocation() {
            const province = document.getElementById('provinceInput').value.trim();
            const city = document.getElementById('cityInput').value.trim();
            const district = document.getElementById('districtInput').value.trim();
            
            if (!province || !city || !district) {
                alert('请填写完整的地址信息');
                return;
            }
            
            selectLocation(province, city, district);
        }

        function getCurrentTransactionId() {
            // 从URL参数或全局变量获取当前事务ID
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('transactionId') || localStorage.getItem('currentTransactionId');
        }

        function showToast(message) {
            // 创建提示框
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // 3秒后自动移除
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 3000);
        }

        // 更新反馈统计信息
        function updateFeedbackStats(items) {
            const newCount = items.filter(item => item.status === 'new').length;
            const processingCount = items.filter(item => item.status === 'processing').length;
            const resolvedCount = items.filter(item => item.status === 'resolved').length;
            const totalCount = items.length;

            document.getElementById('newFeedbackCount').textContent = newCount;
            document.getElementById('processingFeedbackCount').textContent = processingCount;
            document.getElementById('resolvedFeedbackCount').textContent = resolvedCount;
            document.getElementById('totalFeedbackCount').textContent = totalCount;
        }

        // 更新AI总结
        function updateAISummary(items) {
            if (items.length === 0) {
                document.getElementById('aiSummary').innerHTML = '<div class="text-gray-500">暂无反馈数据</div>';
                return;
            }

            // 平均字数
            const totalWords = items.reduce((sum, item) => sum + item.wordCount, 0);
            const avgWords = Math.round(totalWords / items.length);

            // 热门话题分析
            const topics = analyzeHotTopics(items);

            // 反馈趋势分析
            const trend = analyzeFeedbackTrend(items);

            // 处理效率分析
            const efficiency = analyzeProcessingEfficiency(items);

            // 问题分类分析
            const categories = analyzeIssueCategories(items);

            // 用户满意度分析
            const satisfaction = analyzeUserSatisfaction(items);

            // 建议优先级
            const suggestions = generatePrioritySuggestions(items);

            // 重点关注区域
            const focusAreas = analyzeFocusAreas(items);

            // 预期效果分析
            const outcomes = generateExpectedOutcomes(items);

            // 关键洞察分析
            const insights = generateKeyInsights(items);

            // 风险预警分析
            const warnings = generateRiskWarnings(items);

            // 改进优先级分析
            const priorities = generateImprovementPriorities(items);

            // 更新可视化图表
            updateVisualizationCharts(items);
            
            // 更新AI总结内容
            document.getElementById('avgWordCount').textContent = `${avgWords}字`;
            document.getElementById('hotTopics').textContent = topics.join('、');
            document.getElementById('feedbackTrend').textContent = trend;
            document.getElementById('processingEfficiency').textContent = efficiency;
            document.getElementById('issueCategories').textContent = categories;
            document.getElementById('userSatisfaction').textContent = satisfaction;
            document.getElementById('prioritySuggestions').textContent = suggestions.join('、');
            document.getElementById('focusAreas').textContent = focusAreas.join('、');
            document.getElementById('expectedOutcomes').textContent = outcomes;
            document.getElementById('keyInsights').textContent = insights;
            document.getElementById('riskWarnings').textContent = warnings;
            document.getElementById('improvementPriority').textContent = priorities;
            
            // 更新智能建议
            updateSmartSuggestions(items);
        }

        // 分析热门话题
        function analyzeHotTopics(items) {
            const topicKeywords = {
                '办理流程': ['流程', '办理', '手续', '程序'],
                '服务态度': ['态度', '服务', '工作人员', '耐心'],
                '材料简化': ['材料', '简化', '减少', '优化'],
                '网上预约': ['预约', '网上', '在线', '系统'],
                '办理时间': ['时间', '等待', '速度', '效率'],
                '统一标准': ['统一', '标准', '规范', '要求']
            };

            const topicCounts = {};
            Object.keys(topicKeywords).forEach(topic => {
                topicCounts[topic] = 0;
            });

            items.forEach(item => {
                const content = item.title + ' ' + item.content;
                Object.entries(topicKeywords).forEach(([topic, keywords]) => {
                    if (keywords.some(keyword => content.includes(keyword))) {
                        topicCounts[topic]++;
                    }
                });
            });

            // 返回出现次数最多的3个话题
            return Object.entries(topicCounts)
                .filter(([topic, count]) => count > 0)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3)
                .map(([topic]) => topic);
        }

        // 分析反馈趋势
        function analyzeFeedbackTrend(items) {
            // 模拟趋势数据
            const currentWeek = items.length;
            const lastWeek = Math.round(currentWeek * 0.85); // 模拟上周数据
            const growth = Math.round(((currentWeek - lastWeek) / lastWeek) * 100);
            
            const resolvedItems = items.filter(item => item.status === 'resolved');
            const currentSatisfaction = Math.round((resolvedItems.length / items.length) * 100);
            const lastSatisfaction = currentSatisfaction - 8; // 模拟上月满意度
            
            return `本周反馈量较上周${growth > 0 ? '增长' : '减少'}${Math.abs(growth)}%，满意度${currentSatisfaction > lastSatisfaction ? '提升' : '下降'}${Math.abs(currentSatisfaction - lastSatisfaction)}%`;
        }

        // 分析处理效率
        function analyzeProcessingEfficiency(items) {
            const processingItems = items.filter(item => item.status === 'processing');
            const resolvedItems = items.filter(item => item.status === 'resolved');
            
            // 模拟处理时间计算
            const avgProcessingTime = 2.3; // 平均2.3天
            const responseRate = Math.round((resolvedItems.length / items.length) * 100);
            
            let efficiencyLevel = '良好';
            if (avgProcessingTime > 3) efficiencyLevel = '需改进';
            if (avgProcessingTime < 1.5) efficiencyLevel = '优秀';
            
            return `平均处理时间${avgProcessingTime}天，响应速度${efficiencyLevel}，解决率${responseRate}%`;
        }

        // 分析问题分类
        function analyzeIssueCategories(items) {
            const categories = {
                '流程问题': 0,
                '服务态度': 0,
                '材料要求': 0,
                '系统功能': 0,
                '其他': 0
            };
            
            const keywords = {
                '流程问题': ['流程', '手续', '程序', '步骤'],
                '服务态度': ['态度', '服务', '工作人员', '耐心', '礼貌'],
                '材料要求': ['材料', '证明', '证件', '文件'],
                '系统功能': ['系统', '网站', '在线', '预约', '查询']
            };
            
            items.forEach(item => {
                const content = item.title + ' ' + item.content;
                let categorized = false;
                
                Object.entries(keywords).forEach(([category, words]) => {
                    if (words.some(word => content.includes(word))) {
                        categories[category]++;
                        categorized = true;
                    }
                });
                
                if (!categorized) {
                    categories['其他']++;
                }
            });
            
            const total = items.length;
            const percentages = Object.entries(categories).map(([category, count]) => {
                const percent = Math.round((count / total) * 100);
                return `${category}(${percent}%)`;
            });
            
            return percentages.join('、');
        }

        // 分析用户满意度
        function analyzeUserSatisfaction(items) {
            // 基于反馈状态计算满意度
            const resolvedItems = items.filter(item => item.status === 'resolved');
            const satisfactionScore = Math.round((resolvedItems.length / items.length) * 5 * 10) / 10;
            
            // 模拟历史数据
            const lastMonthScore = satisfactionScore - 0.3;
            const improvement = Math.round((satisfactionScore - lastMonthScore) * 10) / 10;
            
            return `整体满意度${satisfactionScore}/5.0，较上月${improvement > 0 ? '提升' : '下降'}${Math.abs(improvement)}分`;
        }

        // 分析重点关注区域
        function analyzeFocusAreas(items) {
            const focusAreas = [];
            
            // 基于反馈内容分析重点区域
            const hasServiceWindow = items.some(item => 
                item.content.includes('窗口') || item.content.includes('柜台')
            );
            if (hasServiceWindow) {
                focusAreas.push('服务窗口');
            }
            
            const hasSocialSecurity = items.some(item => 
                item.content.includes('社保') || item.content.includes('医保')
            );
            if (hasSocialSecurity) {
                focusAreas.push('社保办理');
            }
            
            const hasOnlineSystem = items.some(item => 
                item.content.includes('在线') || item.content.includes('系统')
            );
            if (hasOnlineSystem) {
                focusAreas.push('在线系统');
            }
            
            const hasProcessOptimization = items.some(item => 
                item.content.includes('流程') || item.content.includes('优化')
            );
            if (hasProcessOptimization) {
                focusAreas.push('流程优化');
            }
            
            return focusAreas.length > 0 ? focusAreas : ['服务质量提升'];
        }

        // 生成预期效果
        function generateExpectedOutcomes(items) {
            const newItems = items.filter(item => item.status === 'new');
            const newRate = newItems.length / items.length;
            
            let satisfactionImprovement = 0;
            let efficiencyImprovement = 0;
            
            if (newRate > 0.3) {
                satisfactionImprovement = 20;
                efficiencyImprovement = 30;
            } else if (newRate > 0.2) {
                satisfactionImprovement = 15;
                efficiencyImprovement = 25;
            } else {
                satisfactionImprovement = 10;
                efficiencyImprovement = 20;
            }
            
            return `实施建议后预计满意度提升${satisfactionImprovement}%，处理效率提升${efficiencyImprovement}%`;
        }

        // 更新可视化图表
        function updateVisualizationCharts(items) {
            // 更新处理效率条形图
            const newCount = items.filter(item => item.status === 'new').length;
            const processingCount = items.filter(item => item.status === 'processing').length;
            const resolvedCount = items.filter(item => item.status === 'resolved').length;
            const totalCount = items.length;
            
            const newPercent = totalCount > 0 ? Math.round((newCount / totalCount) * 100) : 0;
            const processingPercent = totalCount > 0 ? Math.round((processingCount / totalCount) * 100) : 0;
            const resolvedPercent = totalCount > 0 ? Math.round((resolvedCount / totalCount) * 100) : 0;
            
            // 更新进度条
            document.getElementById('newProgress').style.width = `${newPercent}%`;
            document.getElementById('processingProgress').style.width = `${processingPercent}%`;
            document.getElementById('resolvedProgress').style.width = `${resolvedPercent}%`;
            
            // 更新数量
            document.getElementById('newCount').textContent = newCount;
            document.getElementById('processingCount').textContent = processingCount;
            document.getElementById('resolvedCount').textContent = resolvedCount;
            
            // 更新时间趋势分析
            updateTimeTrendAnalysis(items);
        }
        


        // 生成关键洞察
        function generateKeyInsights(items) {
            const insights = [];
            
            // 分析在线服务需求
            const onlineServiceFeedback = items.filter(item => 
                item.content.includes('在线') || item.content.includes('系统') || item.content.includes('网站')
            );
            if (onlineServiceFeedback.length > items.length * 0.2) {
                insights.push('用户对在线服务需求增长');
            }
            
            // 分析窗口服务效率
            const windowServiceFeedback = items.filter(item => 
                item.content.includes('窗口') || item.content.includes('柜台') || item.content.includes('等待')
            );
            if (windowServiceFeedback.length > 0) {
                insights.push('窗口服务效率有待提升');
            }
            
            // 分析材料简化需求
            const materialFeedback = items.filter(item => 
                item.content.includes('材料') || item.content.includes('简化') || item.content.includes('证明')
            );
            if (materialFeedback.length > items.length * 0.15) {
                insights.push('材料简化呼声较高');
            }
            
            // 分析流程优化需求
            const processFeedback = items.filter(item => 
                item.content.includes('流程') || item.content.includes('手续') || item.content.includes('复杂')
            );
            if (processFeedback.length > 0) {
                insights.push('流程优化需求明显');
            }
            
            return insights.length > 0 ? insights.join('，') : '服务质量整体良好，持续改进中';
        }

        // 生成风险预警
        function generateRiskWarnings(items) {
            const warnings = [];
            
            // 分析新反馈比例
            const newItems = items.filter(item => item.status === 'new');
            if (newItems.length > items.length * 0.3) {
                warnings.push('新反馈比例较高，需加快处理速度');
            }
            
            // 分析流程复杂问题
            const complexProcessFeedback = items.filter(item => 
                item.content.includes('流程') || item.content.includes('复杂') || item.content.includes('困难')
            );
            if (complexProcessFeedback.length > 0) {
                warnings.push('流程复杂问题需要优化');
            }
            
            // 分析特定区域问题
            const chaoyangFeedback = items.filter(item => 
                item.content.includes('朝阳') || item.content.includes('朝阳区')
            );
            if (chaoyangFeedback.length > 0) {
                warnings.push('需重点关注朝阳区服务窗口');
            }
            
            // 分析处理延迟问题
            const delayFeedback = items.filter(item => 
                item.content.includes('等待') || item.content.includes('时间') || item.content.includes('慢')
            );
            if (delayFeedback.length > items.length * 0.2) {
                warnings.push('处理延迟问题需要解决');
            }
            
            return warnings.length > 0 ? warnings.join('，') : '暂无重大风险预警';
        }

        // 生成改进优先级
        function generateImprovementPriorities(items) {
            const priorities = [];
            
            // 基于反馈内容分析优先级
            const processIssues = items.filter(item => 
                item.content.includes('流程') || item.content.includes('手续')
            );
            if (processIssues.length > 0) {
                priorities.push('1.简化办理流程');
            }
            
            const serviceIssues = items.filter(item => 
                item.content.includes('态度') || item.content.includes('服务') || item.content.includes('窗口')
            );
            if (serviceIssues.length > 0) {
                priorities.push('2.提升窗口服务');
            }
            
            const onlineIssues = items.filter(item => 
                item.content.includes('在线') || item.content.includes('系统')
            );
            if (onlineIssues.length > 0) {
                priorities.push('3.完善在线系统');
            }
            
            const materialIssues = items.filter(item => 
                item.content.includes('材料') || item.content.includes('证明')
            );
            if (materialIssues.length > 0) {
                priorities.push('4.统一材料标准');
            }
            
            // 如果没有特定问题，提供通用优先级
            if (priorities.length === 0) {
                priorities.push('1.持续改进服务质量', '2.优化用户体验', '3.提升服务效率', '4.完善服务流程');
            }
            
            return priorities.join(' ');
        }

        // 更新时间趋势分析
        function updateTimeTrendAnalysis(items) {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            // 模拟时间分布数据
            const todayCount = Math.round(items.length * 0.1);
            const weekCount = Math.round(items.length * 0.3);
            const monthCount = Math.round(items.length * 0.6);
            const totalCount = items.length;
            
            // 更新显示
            document.getElementById('todayCount').textContent = todayCount;
            document.getElementById('weekCount').textContent = weekCount;
            document.getElementById('monthCount').textContent = monthCount;
            document.getElementById('totalCount').textContent = totalCount;
            
            // 分析趋势
            const trend = analyzeTimeTrend(todayCount, weekCount, monthCount);
            document.getElementById('trendAnalysis').textContent = trend;
        }

        // 分析时间趋势
        function analyzeTimeTrend(today, week, month) {
            const weekAvg = week / 7;
            const monthAvg = month / 30;
            
            if (today > weekAvg * 1.2) {
                return '今日反馈量激增，用户参与度显著提升';
            } else if (today > weekAvg * 0.8) {
                return '反馈量呈上升趋势，用户参与度持续提升';
            } else if (today < weekAvg * 0.5) {
                return '今日反馈量较低，建议关注用户参与度';
            } else {
                return '反馈量保持稳定，服务质量良好';
            }
        }

        // 更新智能建议
        function updateSmartSuggestions(items) {
            const suggestions = generateSmartSuggestions(items);
            
            // 更新建议内容
            if (suggestions.length > 0) {
                document.getElementById('suggestion1').textContent = suggestions[0] || '持续改进服务质量';
                document.getElementById('suggestion2').textContent = suggestions[1] || '优化用户体验';
                document.getElementById('suggestion3').textContent = suggestions[2] || '提升服务效率';
                document.getElementById('suggestion4').textContent = suggestions[3] || '完善服务流程';
            }
        }

        // 生成智能建议
        function generateSmartSuggestions(items) {
            const suggestions = [];
            
            // 基于反馈内容生成具体建议
            const chaoyangFeedback = items.filter(item => 
                item.content.includes('朝阳') || item.content.includes('朝阳区')
            );
            if (chaoyangFeedback.length > 0) {
                suggestions.push('优化朝阳区服务窗口人员配置，增加服务人员数量');
            }
            
            const socialSecurityFeedback = items.filter(item => 
                item.content.includes('社保') || item.content.includes('医保')
            );
            if (socialSecurityFeedback.length > 0) {
                suggestions.push('简化社保办理流程，减少不必要的材料要求');
            }
            
            const onlineFeedback = items.filter(item => 
                item.content.includes('在线') || item.content.includes('系统') || item.content.includes('网站')
            );
            if (onlineFeedback.length > 0) {
                suggestions.push('完善在线预约系统，提供更便捷的网上服务');
            }
            
            const serviceAttitudeFeedback = items.filter(item => 
                item.content.includes('态度') || item.content.includes('服务') || item.content.includes('工作人员')
            );
            if (serviceAttitudeFeedback.length > 0) {
                suggestions.push('加强工作人员培训，提升服务态度和专业水平');
            }
            
            const processFeedback = items.filter(item => 
                item.content.includes('流程') || item.content.includes('手续') || item.content.includes('复杂')
            );
            if (processFeedback.length > 0) {
                suggestions.push('简化办理流程，优化服务步骤');
            }
            
            const materialFeedback = items.filter(item => 
                item.content.includes('材料') || item.content.includes('证明') || item.content.includes('证件')
            );
            if (materialFeedback.length > 0) {
                suggestions.push('统一材料标准，减少重复性材料要求');
            }
            
            const timeFeedback = items.filter(item => 
                item.content.includes('时间') || item.content.includes('等待') || item.content.includes('慢')
            );
            if (timeFeedback.length > 0) {
                suggestions.push('优化办理时间，提高服务效率');
            }
            
            // 如果没有特定问题，提供通用建议
            if (suggestions.length === 0) {
                suggestions.push(
                    '持续改进服务质量，提升用户满意度',
                    '优化用户体验，简化操作流程',
                    '加强工作人员培训，提升专业水平',
                    '完善服务流程，提高办理效率'
                );
            }
            
            return suggestions.slice(0, 4); // 最多显示4个建议
        }

        // 生成优先级建议
        function generatePrioritySuggestions(items) {
            const suggestions = [];
            
            // 基于反馈状态的建议
            const newItems = items.filter(item => item.status === 'new');
            if (newItems.length > items.length * 0.3) {
                suggestions.push('加强服务培训');
            }

            // 基于反馈类型的建议
            const complaints = items.filter(item => item.type === 'complaint');
            if (complaints.length > 0) {
                suggestions.push('优化办理流程');
            }

            const inquiries = items.filter(item => item.type === 'inquiry');
            if (inquiries.length > 0) {
                suggestions.push('完善服务指南');
            }

            // 基于内容的建议
            const hasProcessFeedback = items.some(item => 
                item.content.includes('流程') || item.content.includes('手续')
            );
            if (hasProcessFeedback) {
                suggestions.push('简化办理手续');
            }

            const hasTimeFeedback = items.some(item => 
                item.content.includes('时间') || item.content.includes('等待')
            );
            if (hasTimeFeedback) {
                suggestions.push('提高办理效率');
            }

            const hasOnlineFeedback = items.some(item => 
                item.content.includes('在线') || item.content.includes('系统')
            );
            if (hasOnlineFeedback) {
                suggestions.push('完善在线服务');
            }

            const hasMaterialFeedback = items.some(item => 
                item.content.includes('材料') || item.content.includes('证明')
            );
            if (hasMaterialFeedback) {
                suggestions.push('统一材料标准');
            }

            return suggestions.length > 0 ? suggestions : ['持续改进服务质量'];
        }
    </script>
</body>
</html> 
</body>
</html> 